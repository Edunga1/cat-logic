{"componentChunkName":"component---src-components-gatsby-templates-wiki-tsx","path":"/wiki/spring-framework/","result":{"data":{"markdownRemark":{"headings":[{"value":"Spring framework"}],"fields":{"relatedDocs":[{"slug":"javascript","similarity":0.8100494782},{"slug":"web","similarity":0.8212420039},{"slug":"2016-08-27-gdg-webtech-workshop-nnn","similarity":0.8160405801},{"slug":"crontab","similarity":0.7754813493},{"slug":"idea-methodology","similarity":0.7714461816},{"slug":"2016-11-16-google-campus-two-things-you-must-keep-in-google-play","similarity":0.8185245981},{"slug":"spring-framework","similarity":1},{"slug":"aws","similarity":0.8159628688},{"slug":"git","similarity":0.8050176663},{"slug":"algorithm-practice","similarity":0.7065742475},{"slug":"docker","similarity":0.7846747862},{"slug":"scp","similarity":0.7371643005},{"slug":"mac-os","similarity":0.7983650439},{"slug":"testing","similarity":0.8537697414},{"slug":"machine-learning","similarity":0.7959363983},{"slug":"devops","similarity":0.7961160616},{"slug":"python","similarity":0.788097002},{"slug":"object-oriented-programming","similarity":0.8092810391},{"slug":"linux","similarity":0.8258507987},{"slug":"sfml","similarity":0.7707139924},{"slug":"windows","similarity":0.775948286},{"slug":"markdown","similarity":0.7884202819},{"slug":"cat-logic","similarity":0.7915728943},{"slug":"vuejs","similarity":0.7734438707},{"slug":"shell","similarity":0.8081951083},{"slug":"html","similarity":0.7836930245},{"slug":"vimenter-2023","similarity":0.7917430544},{"slug":"data-analysis","similarity":0.7685527381},{"slug":"hardware","similarity":0.7665907355},{"slug":"programming-convention","similarity":0.804502432},{"slug":"webgl","similarity":0.7590582692},{"slug":"sentry","similarity":0.8100061182},{"slug":"valve","similarity":0.7611831156},{"slug":"reactjs","similarity":0.8040454778},{"slug":"airflow","similarity":0.777686387},{"slug":"computer-graphics","similarity":0.7405866854},{"slug":"programming-philosophy","similarity":0.7855398169},{"slug":"elasticsearch","similarity":0.8307276186},{"slug":"unicode","similarity":0.753644066},{"slug":"logging","similarity":0.7919422751},{"slug":"tools","similarity":0.8116441972},{"slug":"programming-paradigm","similarity":0.8036382084},{"slug":"inspiration","similarity":0.7900374239},{"slug":"gatsbyjs","similarity":0.8251486269},{"slug":"design-pattern","similarity":0.8265344684},{"slug":"game","similarity":0.7949695719},{"slug":"kubernetes","similarity":0.8009495806},{"slug":"nodejs","similarity":0.8125237889},{"slug":"continuous-integration-and-deployment","similarity":0.8137349173},{"slug":"rust","similarity":0.7692043368},{"slug":"book","similarity":0.7969237702},{"slug":"jetbrains","similarity":0.8478513331},{"slug":"quotation","similarity":0.7719875675},{"slug":"jira","similarity":0.7995479492},{"slug":"swagger","similarity":0.8443530542},{"slug":"architecture","similarity":0.8785941384},{"slug":"unity3d","similarity":0.8013333492},{"slug":"jargon","similarity":0.8152221404},{"slug":"language-server-protocol","similarity":0.7679083321},{"slug":"clean-code","similarity":0.7831129081},{"slug":"java","similarity":0.8688450395},{"slug":"windows-subsystem-for-linux","similarity":0.7762370181},{"slug":"test-driven-development","similarity":0.8107208027},{"slug":"github","similarity":0.78639134},{"slug":"network","similarity":0.7894975499},{"slug":"kotlin","similarity":0.8542866865},{"slug":"c-sharp","similarity":0.7658356543},{"slug":"angularjs","similarity":0.8343541576},{"slug":"vim","similarity":0.7909481735},{"slug":"ionic-framework","similarity":0.7842869423},{"slug":"physics","similarity":0.7632295977},{"slug":"html-canvas","similarity":0.7418282796},{"slug":"reverse-engineering","similarity":0.7667159895},{"slug":"css","similarity":0.7763496441},{"slug":"code-review","similarity":0.8053177716},{"slug":"software-development","similarity":0.8480007206},{"slug":"database","similarity":0.8281855435},{"slug":"reactive-extensions","similarity":0.7726194769},{"slug":"redis","similarity":0.7556186386},{"slug":"mail","similarity":0.7864186863},{"slug":"experience-review","similarity":0.7935638306},{"slug":"google-analytics","similarity":0.7699514079},{"slug":"data-structure","similarity":0.7879823338},{"slug":"vimwiki","similarity":0.7864133643},{"slug":"추론 애플리케이션","similarity":0.7897605752}]},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#spring-framework\">Spring framework</a></p>\n<ul>\n<li>\n<p><a href=\"#features\">Features</a></p>\n<ul>\n<li>\n<p><a href=\"#requestmapping-request-mapping-narrowing\"><code>RequestMapping</code> Request mapping narrowing</a></p>\n<ul>\n<li>\n<p><a href=\"#parameters\">parameters</a></p>\n<ul>\n<li><a href=\"#value-alias-of-path\"><code>value</code> (alias of <code>path</code>)</a></li>\n<li><a href=\"#params\"><code>params</code></a></li>\n<li><a href=\"#headers\"><code>headers</code></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#test\">Test</a></p>\n<ul>\n<li><a href=\"#transactional-test\">Transactional Test</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#application-properties\">Application Properties</a></p>\n</li>\n<li>\n<p><a href=\"#uri-links\">URI Links</a></p>\n</li>\n<li>\n<p><a href=\"#actuator\">Actuator</a></p>\n<ul>\n<li><a href=\"#httptracehttpexchanges\">httptrace(httpexchanges)</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#spring-cli\">Spring CLI</a></p>\n<ul>\n<li><a href=\"#%EB%B9%A0%EB%A5%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1\">빠른 프로젝트 생성</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#caching\">Caching</a></p>\n<ul>\n<li><a href=\"#caffeine\">Caffeine</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#troubleshooting\">Troubleshooting</a></p>\n<ul>\n<li><a href=\"#intellij%EC%97%90%EC%84%9C-properties%EC%9D%98-%EC%84%A0%EC%96%B8%EB%B6%80%EB%A5%BC-%EC%B0%BE%EC%9D%84-%EC%88%98-%EC%97%86%EB%8A%94-%EA%B2%BD%EC%9A%B0\">IntelliJ에서 Properties의 선언부를 찾을 수 없는 경우</a></li>\n<li><a href=\"#webclient-%EC%B2%AB-%EC%9A%94%EC%B2%AD%EC%9D%B4-%EB%8A%90%EB%A6%B0-%EB%AC%B8%EC%A0%9C\">WebClient 첫 요청이 느린 문제</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","html":"<h1 id=\"spring-framework\" style=\"position:relative;\"><a href=\"#spring-framework\" aria-label=\"spring framework permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring framework</h1>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/index.html\">Spring Boot Reference Documentation</a></p>\n<h2 id=\"features\" style=\"position:relative;\"><a href=\"#features\" aria-label=\"features permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Features</h2>\n<h3 id=\"requestmapping-request-mapping-narrowing\" style=\"position:relative;\"><a href=\"#requestmapping-request-mapping-narrowing\" aria-label=\"requestmapping request mapping narrowing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>RequestMapping</code> Request mapping narrowing</h3>\n<p><a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html\">RequestMapping - Spring API</a></p>\n<p><code>@RequestMapping</code>는 Controller의 매핑 범위를 줄이는 파라미터를 제공한다.</p>\n<p><code>@GetMapping</code> <code>@PostMapping</code> 사용하여 우선 method로 선택 범위를 좁힐 수 있다.</p>\n<h4 id=\"parameters\" style=\"position:relative;\"><a href=\"#parameters\" aria-label=\"parameters permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>parameters</h4>\n<h5 id=\"value-alias-of-path\" style=\"position:relative;\"><a href=\"#value-alias-of-path\" aria-label=\"value alias of path permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>value</code> (alias of <code>path</code>)</h5>\n<p>가장 기본적인 인자로, url path를 매핑한다. 기본 값은 빈 문자열이므로 <code>/</code> 와 같다.</p>\n<h5 id=\"params\" style=\"position:relative;\"><a href=\"#params\" aria-label=\"params permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>params</code></h5>\n<p>query-string 매핑.</p>\n<ul>\n<li><code>myParam=myValue</code> 특정 값인 경우만 매핑한다.</li>\n<li><code>myParam!=myValue</code> 위의 반대. 특정 값이 아닌 경우만 매핑한다.</li>\n<li><code>!myParam</code> <code>myParam</code> 파라미터 자체가 제공된 경우만 매핑한다.</li>\n</ul>\n<h5 id=\"headers\" style=\"position:relative;\"><a href=\"#headers\" aria-label=\"headers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code>headers</code></h5>\n<p>header 매핑.</p>\n<p><code>@RequestMapping(value = \"/something\", headers = \"content-type=text/*\")</code></p>\n<p>wildcard를 사용한 경우 <code>text/plain</code> <code>text/html</code> 모두 매핑한다.</p>\n<h3 id=\"test\" style=\"position:relative;\"><a href=\"#test\" aria-label=\"test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Test</h3>\n<h4 id=\"transactional-test\" style=\"position:relative;\"><a href=\"#transactional-test\" aria-label=\"transactional test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transactional Test</h4>\n<p>통합 테스트에서 teardown 시점에 트랜잭션을 롤백하는 방법은 편리해서 자주 사용하는 방법이다.</p>\n<p>SpringBootTest에서는 <code>@Transactional</code>을 사용하여 테스트 후에 롤백할 수 있다:</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Import(TestClientConfig::class)\n@ExtendWith(SpringExtension::class)\n@AutoConfigureWebTestClient\n@SpringBootTest\n@Transactional\nclass UserAddressTest {\n  @Autowired\n  lateinit var userAddressRepository: UserAddressRepository\n\n  @BeforeEach\n  fun prepare() {\n    userAddressRepository.save(UserAddress(uid = 1234, address1 = &quot;서울시&quot;))\n  }\n\n  @Test\n  fun test1() {\n    assertThat(userAddressRepository.count()).isEqualTo(1)\n  }\n\n  @Test\n  fun test2() {\n    assertThat(userAddressRepository.count()).isEqualTo(1)\n  }\n}</code>\n        </deckgo-highlight-code>\n<p>하지만 <code>@Nested</code> 클래스에서는 롤백되지 않는다:</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Import(TestClientConfig::class)\n@ExtendWith(SpringExtension::class)\n@AutoConfigureWebTestClient\n@SpringBootTest\n@Transactional\nclass DescribeShippingAddressDetailAAA {\n  @Autowired\n  lateinit var userAddressRepository: UserAddressRepository\n\n  @BeforeEach\n  fun prepare() {\n    userAddressRepository.save(UserAddress(uid = 1234, address1 = &quot;서울시 구로구 구로동&quot;))\n  }\n\n  @Nested\n  inner class Context {\n    @Test\n    fun test1() {\n      assertThat(userAddressRepository.count()).isEqualTo(1)\n    }\n\n    @Test\n    fun test2() {\n      assertThat(userAddressRepository.count()).isEqualTo(1)\n    }\n  }\n}</code>\n        </deckgo-highlight-code>\n<p><code>@Nested</code>에서 롤백되지 않는 것은 <a href=\"https://stackoverflow.com/questions/44203244/transaction-roll-back-is-not-working-in-test-case-in-nested-class-of-junit5\">예상 가능한 범위</a>라고\nSpring TestContext Framework 개발자가 말한다:</p>\n<blockquote>\n<p>This is to be expected: the Spring TestContext Framework has never supported \"inheritance\" for nested test classes.</p>\n</blockquote>\n<p>다만 이를 지원할 수 있도록 작업한 모양이다.\n<a href=\"https://jira.spring.io/browse/SPR-15366\">SPR-15366</a> 이슈에서 <code>@Nested</code>에 대한 처리를 진행했다.\nSpring 5.3의 마일스톤에 포함되어 있다.</p>\n<p>이 작업이 <a href=\"https://docs.spring.io/spring-framework/reference/testing/annotations/integration-junit-jupiter.html#integration-testing-annotations-nestedtestconfiguration\">@NestedTestConfiguration</a>에 대한 내용으로 보인다.</p>\n<h3 id=\"application-properties\" style=\"position:relative;\"><a href=\"#application-properties\" aria-label=\"application properties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Application Properties</h3>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html\">https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html</a></p>\n<p>Spring Boot는 <code>application.properties</code>, <code>application.yaml</code>, 환경변수, command-line 인자로부터 설정값을 받을 수 있다.</p>\n<p><code>@configurationProperties</code>가 설정된 클래스에 매핑해 주는데 <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.external-config.typesafe-configuration-properties.relaxed-binding\">Relaxed Binding</a>을 사용한다.</p>\n<p>매우 관대한 규칙으로 property에 binding 하는데, <a href=\"https://github.com/spring-projects/spring-boot/wiki/Relaxed-Binding-2.0\">Relaxed Binding 2.0 Github Wiki</a>에 그 규칙을 설명하고 있다.</p>\n<p>예를들어 다음 설정은 모두 같은 것을 의미한다:</p>\n<deckgo-highlight-code   >\n          <code slot=\"code\">spring.jpa.database-platform=mysql\nspring.jpa.databasePlatform=mysql\nspring.JPA.database_platform=mysql</code>\n        </deckgo-highlight-code>\n<p>공식적으로 추천하는 포맷은 kebab-case를 사용하는 것이다:</p>\n<blockquote>\n<p>We recommend that properties are stored in lowercase kabab format. i.e. <code>my.property-name=foo</code>.</p>\n</blockquote>\n<p><code>@ConfigurationProperties</code> 예시. 생성자를 통해서 주입받는다.</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@ConstructorBinding\n@ConfigurationProperties(prefix = &quot;foo.bar&quot;)\nclass MyConfig(val baz: String)\n\n// ConstructorBinding 사용하려면 EnableConfigurationProperties가 필요\n@EnableConfigurationProperties(MyConfig::class)\n@SpringBootApplication\nclass Application</code>\n        </deckgo-highlight-code>\n<h3 id=\"uri-links\" style=\"position:relative;\"><a href=\"#uri-links\" aria-label=\"uri links permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URI Links</h3>\n<p><a href=\"https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-uri-building.html#uri-encoding\">https://docs.spring.io/spring-framework/reference/web/webmvc/mvc-uri-building.html#uri-encoding</a></p>\n<p><code>UriComponentsBuilder</code>로 query parameter에 URL을 전달하기 위해 다음과 같이 작성하면 인코딩 문제가 발생한다.</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">fun build(url: String) = UriComponentsBuilder\n  .fromUriString(&quot;https://example.com&quot;)\n  .queryParam(&quot;url&quot;, url)\n  .build()\n  .toString()\n\nbuild(&quot;https://www.google.com/search?q=%ED%91%B8%EB%B0%94&amp;oq=%ED%91%B8%EB%B0%94&amp;aqs=chrome..69i64j46i340i512j0i512l8.2053j0j1&amp;sourceid=chrome&amp;ie=UTF-8&quot;)\n// https://example.com?url=https://www.google.com/search?q=%ED%91%B8%EB%B0%94&amp;oq=%ED%91%B8%EB%B0%94&amp;aqs=chrome..69i64j46i340i512j0i512l8.2053j0j1&amp;sourceid=chrome&amp;ie=UTF-8</code>\n        </deckgo-highlight-code>\n<p><code>url=</code> 파라미터의 url에 포함된 slash가 인코딩 되지 않는다.</p>\n<p>다음과 같이 <code>build()</code>로 전달하면 올바르게 인코딩한다.</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">fun build(url: String) = UriComponentsBuilder\n    .fromUriString(&quot;https://example.com&quot;)\n    .queryParam(&quot;url&quot;, &quot;{url}&quot;)\n    .build(url)\n    .toString()\n\nbuild(&quot;https://www.google.com/search?q=%ED%91%B8%EB%B0%94&amp;oq=%ED%91%B8%EB%B0%94&amp;aqs=chrome..69i64j46i340i512j0i512l8.2053j0j1&amp;sourceid=chrome&amp;ie=UTF-8&quot;)\n// https://example.com?url=https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3D%25ED%2591%25B8%25EB%25B0%2594%26oq%3D%25ED%2591%25B8%25EB%25B0%2594%26aqs%3Dchrome..69i64j46i340i512j0i512l8.2053j0j1%26sourceid%3Dchrome%26ie%3DUTF-8</code>\n        </deckgo-highlight-code>\n<p><code>/</code>, <code>=</code>, <code>&#x26;</code> 등 URI 요소를 인코딩한 것을 볼 수 있다.</p>\n<p>placeholder<code>{url}</code>는 사용하지 않았고, build로 전달하는 순서대로 replace 한다.</p>\n<h3 id=\"actuator\" style=\"position:relative;\"><a href=\"#actuator\" aria-label=\"actuator permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Actuator</h3>\n<p>Spring Boot는 Actuator로 운영 환경에서 사용할 수 있는 모니터링 및 관리 도구를 제공한다.</p>\n<ul>\n<li>2.1.0 문서: <a href=\"https://docs.spring.io/spring-boot/docs/2.1.0.M1/reference/html/production-ready.html\">https://docs.spring.io/spring-boot/docs/2.1.0.M1/reference/html/production-ready.html</a></li>\n<li>3.2.x 문서: <a href=\"https://docs.spring.io/spring-boot/docs/3.2.x/reference/html/actuator.html#actuator\">https://docs.spring.io/spring-boot/docs/3.2.x/reference/html/actuator.html#actuator</a></li>\n</ul>\n<p>문서 제목부터 <em>Production-ready Features</em>로 안정감이 느껴진다.</p>\n<p>기본적으로 <code>/actuator</code>에서 현재 제공하고 있는 도구 목록을 보여주는데, json으로 제공된다:</p>\n<deckgo-highlight-code language=\"json\"  >\n          <code slot=\"code\">{\n  &quot;_links&quot;: {\n    &quot;self&quot;: {\n      &quot;href&quot;: &quot;http://localhost:5001/actuator&quot;,\n      &quot;templated&quot;: false\n    },\n    &quot;beans&quot;: {\n      &quot;href&quot;: &quot;http://localhost:5001/actuator/beans&quot;,\n      &quot;templated&quot;: false\n    },\n    &quot;health&quot;: {\n      &quot;href&quot;: &quot;http://localhost:5001/actuator/health&quot;,\n      &quot;templated&quot;: false\n    },\n    &quot;health-path&quot;: {\n      &quot;href&quot;: &quot;http://localhost:5001/actuator/health/{*path}&quot;,\n      &quot;templated&quot;: true\n    },\n    &quot;httptrace&quot;: {\n      &quot;href&quot;: &quot;http://localhost:5001/actuator/httptrace&quot;,\n      &quot;templated&quot;: false\n    }\n  }\n}</code>\n        </deckgo-highlight-code>\n<h4 id=\"httptracehttpexchanges\" style=\"position:relative;\"><a href=\"#httptracehttpexchanges\" aria-label=\"httptracehttpexchanges permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>httptrace(httpexchanges)</h4>\n<p>httptrace는 최근 HTTP 요청 내역을 관리하는 기능이다. Spring Boot 3 부터는 <code>httpexchanges</code>라 부른다.</p>\n<ul>\n<li>2.1.0: <a href=\"https://docs.spring.io/spring-boot/docs/2.1.0.M1/reference/html/production-ready-http-tracing.html\">https://docs.spring.io/spring-boot/docs/2.1.0.M1/reference/html/production-ready-http-tracing.html</a></li>\n<li>3.2.x: <a href=\"https://docs.spring.io/spring-boot/docs/3.2.x/reference/html/actuator.html#actuator.http-exchanges\">https://docs.spring.io/spring-boot/docs/3.2.x/reference/html/actuator.html#actuator.http-exchanges</a></li>\n</ul>\n<p>기능 활성화를 위해서 버전에 따라 설정이 상이하다.</p>\n<p>2.7.5 기준으로 <code>management.endpoints.web.exposure.include=httptrace</code>를 설정 추가하고, <code>HttpTraceRepository</code> Bean을 구현하면 활성화 할 수 있다.<br>\nBean 구현하는 것은 <a href=\"https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.2.0-M3-Release-Notes#actuator-http-trace-and-auditing-are-disabled-by-default\">2.2.0 M3 부터 변경</a>되었는데, 이전 버전에서는 구현없이 가능했던 모양.</p>\n<p>Spring Boot 3부터는 명칭 변경으로 <code>management.endpoints.web.exposure.include=httpexchanges</code>로 변경되었다.\nBean 인터페이스 이름도 <code>HttpExchangeRepository</code>로 변경되었다.</p>\n<p>어느 버전이든 <code>HttpTraceRepository</code>를 in-memory 버전 저장소로 간편하게 구현할 수 있다.<br>\n다음은 Spring Boot 2 기준 예시 코드:</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Bean\nfun httpTraceRepository(): HttpTraceRepository = InMemoryHttpTraceRepository()</code>\n        </deckgo-highlight-code>\n<p>내 경우, 운영에서는 <code>health</code> 말고는 Actuator 기능을 비활성화했기 때문에 Bean 생성 조건에 property 확인을 추가했다:</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Bean\n@ConditionalOnExpression(&quot;&#39;\\${management.endpoints.web.exposure.include}&#39;.contains(&#39;httptrace&#39;)&quot;)\nfun httpTraceRepository(): HttpTraceRepository = InMemoryHttpTraceRepository()</code>\n        </deckgo-highlight-code>\n<p>서버 시작 후 <code>/actuator/httptrace</code>에 접속하면 json으로 제공한다.</p>\n<deckgo-highlight-code language=\"json\"  >\n          <code slot=\"code\">{\n  &quot;traces&quot;: [\n    {\n      &quot;timestamp&quot;: &quot;2023-12-27T08:24:56.956Z&quot;,\n      &quot;principal&quot;: null,\n      &quot;session&quot;: null,\n      &quot;request&quot;: {\n        &quot;method&quot;: &quot;GET&quot;,\n        &quot;uri&quot;: &quot;http://localhost:5001/actuator/&quot;,\n        &quot;headers&quot;: {\n          &quot;sec-fetch-mode&quot;: [\n            &quot;navigate&quot;\n          ]\n          // ... 생략\n        },\n        &quot;remoteAddress&quot;: null\n      },\n      &quot;response&quot;: {\n        &quot;status&quot;: 200,\n        &quot;headers&quot;: {\n          &quot;Keep-Alive&quot;: [\n            &quot;timeout=60&quot;\n          ]\n          // ... 생략\n        }\n      },\n      &quot;timeTaken&quot;: 27\n    }\n  ]\n}</code>\n        </deckgo-highlight-code>\n<p>actuator 페이지 접근을 위해 기록된 것을 볼 수 있다.\n최근 요청의 헤더 정보, 응답 코드, URL 등을 알 수 있다.</p>\n<h2 id=\"spring-cli\" style=\"position:relative;\"><a href=\"#spring-cli\" aria-label=\"spring cli permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring CLI</h2>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/cli.html\">https://docs.spring.io/spring-boot/docs/current/reference/html/cli.html</a></p>\n<p>Installation(Homebrew):</p>\n<deckgo-highlight-code language=\"bash\"  >\n          <code slot=\"code\">$ brew tap spring-io/tap\n$ brew install spring-boot</code>\n        </deckgo-highlight-code>\n<p>도움말 확인하려면 <code>spring help &#x3C;command></code><br>\ne.g. <code>spring help init</code></p>\n<h3 id=\"빠른-프로젝트-생성\" style=\"position:relative;\"><a href=\"#%EB%B9%A0%EB%A5%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%83%9D%EC%84%B1\" aria-label=\"빠른 프로젝트 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>빠른 프로젝트 생성</h3>\n<p>Kotlin + Spring Boot + Gradle 프로젝트를 빠르게 생성 해보자.</p>\n<deckgo-highlight-code language=\"bash\"  >\n          <code slot=\"code\">spring init --language kotlin --type gradle-project-kotlin --extract demo</code>\n        </deckgo-highlight-code>\n<p><code>demo</code> 디렉토리와 함께 프로젝트가 생성된다.<br>\n<code>--extract</code> 옵션을 생략하면 zip 파일로 생성된다.</p>\n<p>Application 코드를 생성해 주지만 <code>ApplicationRunner</code>로 간단하게 hello world 출력해보자:</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@SpringBootApplication\nclass DemoApplication: ApplicationRunner {\n    override fun run(args: ApplicationArguments) {\n        println(&quot;Hello, world!&quot;)\n    }\n}\n\nfun main(args: Array&lt;String&gt;) {\n    runApplication&lt;DemoApplication&gt;(*args)\n}</code>\n        </deckgo-highlight-code>\n<hr>\n<p><code>spring init --list</code>로 설정 기본값을 확인할 수 있다:</p>\n<deckgo-highlight-code language=\"bash\"  >\n          <code slot=\"code\">Parameters\n+-------------+------------------------------------------+------------------------------+\n| Id          | Description                              | Default value                |\n+-------------+------------------------------------------+------------------------------+\n| artifactId  | project coordinates (infer archive name) | demo                         |\n| bootVersion | spring boot version                      | 3.0.4                        |\n| description | project description                      | Demo project for Spring Boot |\n| groupId     | project coordinates                      | com.example                  |\n| javaVersion | language level                           | 17                           |\n| language    | programming language                     | java                         |\n| name        | project name (infer application name)    | demo                         |\n| packageName | root package                             | com.example.demo             |\n| packaging   | project packaging                        | jar                          |\n| type        | project type                             | gradle-project               |\n| version     | project version                          | 0.0.1-SNAPSHOT               |\n+-------------+------------------------------------------+------------------------------+</code>\n        </deckgo-highlight-code>\n<p><code>--type</code> 옵션에 사용 할 프로젝트 유형 목록도 표시된다:</p>\n<deckgo-highlight-code language=\"bash\"  >\n          <code slot=\"code\">Project types (* denotes the default)\n+-----------------------+--------------------------------------------------------------+--------------------------------------------+\n| Id                    | Description                                                  | Tags                                       |\n+-----------------------+--------------------------------------------------------------+--------------------------------------------+\n| gradle-build          | Generate a Gradle build file.                                | build:gradle,format:build                  |\n|                       |                                                              |                                            |\n| gradle-project *      | Generate a Gradle based project archive using the Groovy     | build:gradle,dialect:groovy,format:project |\n|                       | DSL.                                                         |                                            |\n|                       |                                                              |                                            |\n| gradle-project-kotlin | Generate a Gradle based project archive using the Kotlin     | build:gradle,dialect:kotlin,format:project |\n|                       | DSL.                                                         |                                            |\n|                       |                                                              |                                            |\n| maven-build           | Generate a Maven pom.xml.                                    | build:maven,format:build                   |\n|                       |                                                              |                                            |\n| maven-project         | Generate a Maven based project archive.                      | build:maven,format:project                 |\n+-----------------------+--------------------------------------------------------------+--------------------------------------------+</code>\n        </deckgo-highlight-code>\n<p>포함할 의존성도 선택할 수 있는데, 간단한 설명이 포함되어 있어서 유용하다:</p>\n<deckgo-highlight-code language=\"bash\"  >\n          <code slot=\"code\">Supported dependencies\n+--------------------------------------+--------------------------------------------------------------+-------------------------------+\n| Id                                   | Description                                                  | Required version              |\n+--------------------------------------+--------------------------------------------------------------+-------------------------------+\n| activemq                             | Spring JMS support with Apache ActiveMQ &#39;Classic&#39;.           |                               |\n|                                      |                                                              |                               |\n| actuator                             | Supports built in (or custom) endpoints that let you monitor |                               |\n|                                      | and manage your application - such as application health,    |                               |\n|                                      | metrics, sessions, etc.                                      |                               |\n|                                      |                                                              |                               |\n| webflux                              | Build reactive web applications with Spring WebFlux and      |                               |\n|                                      | Netty.                                                       |                               |\n|                                      |                                                              |                               |\n| websocket                            | Build Servlet-based WebSocket applications with SockJS and   |                               |\n|                                      | STOMP.                                                       |                               |\n|                                      |                                                              |                               |\n| zipkin                               | Enable and expose span and trace IDs to Zipkin.              |                               |\n+--------------------------------------+--------------------------------------------------------------+-------------------------------+</code>\n        </deckgo-highlight-code>\n<p>의존성을 추가하려면 <code>--dependencies=actuator,webflux</code>와 같이 사용한다.</p>\n<h2 id=\"caching\" style=\"position:relative;\"><a href=\"#caching\" aria-label=\"caching permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Caching</h2>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/boot-features-caching.html\">https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/boot-features-caching.html</a></p>\n<blockquote>\n<p>Use the spring-boot-starter-cache “Starter” to quickly add basic caching dependencies. The starter brings in spring-context-support.</p>\n</blockquote>\n<p><code>spring-boot-starter-cache</code>를 사용하면 간단한 설정으로 캐싱 모듈을 사용할 수 있는 거 같다.\n일단 내 경우에는 간단한 형태는 아니고, 함수마다 각기 다른 캐시 만료 정책을 적용하기 위해서 <code>CacheManager</code>를 직접 구성해야 했고,\n직접 구성하니 <code>spring-boot-starter-cache</code>는 필요하지 않았다.</p>\n<h3 id=\"caffeine\" style=\"position:relative;\"><a href=\"#caffeine\" aria-label=\"caffeine permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Caffeine</h3>\n<p>로컬 캐시 용도로 Caffeine만 써봤다.\n<a href=\"https://github.com/ben-manes/caffeine/wiki/Benchmarks\">Caffeine에서 제공하는 벤치마크</a>로는 가장 우수하다.</p>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/dependency-versions.html#:~:text=2.15.2-,com.github.ben%2Dmanes.caffeine,-caffeine\">spring managed dependency</a>이므로 버전을 직접 지정할 필요는 없다.</p>\n<blockquote>\n<p>If Caffeine is present, a CaffeineCacheManager (provided by the spring-boot-starter-cache “Starter”)</p>\n</blockquote>\n<p><code>spring-boot-starter-cache</code>를 사용하면 <code>CaffeineCacheManager</code>를 알아서 만들어 준다고 한다.\n내 경우에는 직접 <code>CacheManager</code> 구성해서 <code>spring-boot-starter-cache</code>가 필요하지 않았다.</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@EnableCaching\n@Configuration\nclass CacheConfig {\n    @Bean\n    fun cacheManager(): CacheManager {\n        val caches = CacheType.values().map {\n            CaffeineCache(\n                it.cacheName,\n                Caffeine.newBuilder()\n                    .expireAfterWrite(it.duration)\n                    .build()\n            )\n        }\n        return SimpleCacheManager().also {\n            it.setCaches(caches)\n        }\n    }\n}\n\nenum class CacheType(\n    val cacheName: String,\n    val duration: Duration,\n) {\n    CACHE_POLICY1(&quot;policy1&quot;, Duration.ofMinutes(10)),\n    CACHE_POLICY2(&quot;policy2&quot;, Duration.ofMinutes(50)),\n    ;\n}</code>\n        </deckgo-highlight-code>\n<p>enum으로 만료 시간에 다른 캐시 정책을 여러개 만들었다.</p>\n<deckgo-highlight-code language=\"kotlin\"  >\n          <code slot=\"code\">@Cacheable(cacheNames = [&quot;policy1&quot;])\nfun getItems(): Set&lt;Items&gt; = repository.find()</code>\n        </deckgo-highlight-code>\n<p>사용을 위해선 캐시 이름을 맞춰서 사용한다.\n캐시 이름이 변경되면 캐시 선언 부분과 사용 부분 모두 수정하는데, 이는 캐시 이름을 <code>const val</code>로 만들어서 처리할 수 있다.</p>\n<h2 id=\"troubleshooting\" style=\"position:relative;\"><a href=\"#troubleshooting\" aria-label=\"troubleshooting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Troubleshooting</h2>\n<h3 id=\"intellij에서-properties의-선언부를-찾을-수-없는-경우\" style=\"position:relative;\"><a href=\"#intellij%EC%97%90%EC%84%9C-properties%EC%9D%98-%EC%84%A0%EC%96%B8%EB%B6%80%EB%A5%BC-%EC%B0%BE%EC%9D%84-%EC%88%98-%EC%97%86%EB%8A%94-%EA%B2%BD%EC%9A%B0\" aria-label=\"intellij에서 properties의 선언부를 찾을 수 없는 경우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IntelliJ에서 Properties의 선언부를 찾을 수 없는 경우</h3>\n<p><code>@ConfigurationProperties(prefix=\"foo.bar\")</code>가 선언된 클래스가 있음에도 <code>application.yml</code>에서 선언부를 찾지 못하고,\n<code>Cannot resolve configuration property 'foo.bar'</code> 경고가 출력되는 문제. 서버 시작은 잘 된다.</p>\n<p><code>org.springframework.boot:spring-boot-configuration-processor</code> 의존성을 추가하고, <code>gradle compileJava</code>를 실행하면 된다.</p>\n<p>gradle(kts) 예시:</p>\n<deckgo-highlight-code language=\"gradle\"  >\n          <code slot=\"code\">kapt(&quot;org.springframework.boot:spring-boot-configuration-processor&quot;)</code>\n        </deckgo-highlight-code>\n<h3 id=\"webclient-첫-요청이-느린-문제\" style=\"position:relative;\"><a href=\"#webclient-%EC%B2%AB-%EC%9A%94%EC%B2%AD%EC%9D%B4-%EB%8A%90%EB%A6%B0-%EB%AC%B8%EC%A0%9C\" aria-label=\"webclient 첫 요청이 느린 문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebClient 첫 요청이 느린 문제</h3>\n<p>상황: 서버 시작 직후 다른 서버의 API를 호출하는 내 API가 느려서 클라이언트에서 타임아웃이 자주 발생함.<br>\n해결: netty http client의 <code>warmup</code> + 사용자 진입 전 미리 타겟 서버 API 호출</p>\n<p><a href=\"https://projectreactor.io/docs/netty/release/reference/index.html#_eager_initialization_4\">https://projectreactor.io/docs/netty/release/reference/index.html#_eager_initialization_4</a></p>\n<ol>\n<li>warmup으로 event loop pool을 준비시키고</li>\n<li>서버 시작 시 임의로 호출하여 모든 사용자 요청은 첫 요청 이후가 되도록 한다.</li>\n</ol>\n<p>2의 임의 호출은 해당 서버의 health check가 되는 API로 했다.</p>\n<p>문서에서 설명하는 첫 요청에서 시간을 소요하는 요소는 다음과 같다:</p>\n<ol>\n<li>event loop group</li>\n<li>host name resolver</li>\n<li>내장된 transport 라이브러리들</li>\n<li>보안과 관련된 라이브러리들</li>\n</ol>"}},"pageContext":{"id":"623b17b4-5278-5969-8b27-1f7cb204a495"}},"staticQueryHashes":[],"slicesMap":{}}