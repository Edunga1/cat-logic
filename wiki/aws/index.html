<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.10.0"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style data-styled="" data-styled-version="5.3.6">.hbDcaS{box-sizing:border-box;padding:4rem 2rem 0 0;background-color:#f5f5f5;}/*!sc*/
.hbDcaS ul{list-style:none;padding-left:1rem;font-size:.8rem;font-weight:bold;}/*!sc*/
.hbDcaS ul ul{font-size:.6rem;font-weight:normal;}/*!sc*/
.hbDcaS ul p{margin:0;}/*!sc*/
.hbDcaS a{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g1[id="Toc__Container-sc-1f76i2s-0"]{content:"hbDcaS,"}/*!sc*/
.iPgyli{padding-left:1rem;}/*!sc*/
.iPgyli a{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g2[id="WikiContent__Container-sc-q3jb6a-0"]{content:"iPgyli,"}/*!sc*/
.gVurN{display:grid;grid-template-columns:minmax(300px,1fr) minmax(400px,1000px);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;}/*!sc*/
@media (max-width:1000px){.gVurN{grid-template-columns:1fr;}.gVurN > div:nth-child(1){display:none;}}/*!sc*/
data-styled.g3[id="markdownRemarkfields__slug__Container-sc-cg714z-0"]{content:"gVurN,"}/*!sc*/
</style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="markdownRemarkfields__slug__Container-sc-cg714z-0 gVurN"><div><div class="Toc__Container-sc-1f76i2s-0 hbDcaS"><ul>
<li>
<p><a href="#amazon-web-service">Amazon Web Service</a></p>
</li>
<li>
<p><a href="#awscli"><code>awscli</code></a></p>
<ul>
<li><a href="#ecr-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%98%EA%B8%B0">ECR 로그인하기</a></li>
<li><a href="#iam-%EA%B4%80%EB%A0%A8">IAM 관련</a></li>
</ul>
</li>
<li>
<p><a href="#localstack">LocalStack</a></p>
</li>
<li>
<p><a href="#kinesis">Kinesis</a></p>
<ul>
<li>
<p><a href="#%EA%B0%9C%EB%85%90">개념</a></p>
<ul>
<li><a href="#fan-out">fan-out</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%9E%90%EB%B0%94-%EC%99%B8-%EC%96%B8%EC%96%B4%EB%A1%9C-kinesis-%EC%95%B1-%EA%B0%9C%EB%B0%9C">자바 외 언어로 Kinesis 앱 개발</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#storage-service">Storage Service</a></p>
<ul>
<li><a href="#ebs---elastic-block-storage">EBS - Elastic Block Storage</a></li>
<li><a href="#efs---elastic-file-system">EFS - Elastic File System</a></li>
<li><a href="#object-storage">Object Storage</a></li>
</ul>
</li>
<li>
<p><a href="#networking">Networking</a></p>
<ul>
<li>
<p><a href="#%EC%A3%BC%EC%9A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%82%B9-%EC%84%9C%EB%B9%84%EC%8A%A4">주요 네트워킹 서비스</a></p>
<ul>
<li><a href="#vpc---virtual-private-cloud">VPC - Virtual Private Cloud</a></li>
<li><a href="#direct-connect">Direct Connect</a></li>
<li><a href="#route-53">Route 53</a></li>
</ul>
</li>
</ul>
</li>
</ul></div></div><div class="WikiContent__Container-sc-q3jb6a-0 iPgyli"><h1 id="amazon-web-service" style="position:relative;"><a href="#amazon-web-service" aria-label="amazon web service permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Amazon Web Service</h1>
<h1 id="awscli" style="position:relative;"><a href="#awscli" aria-label="awscli permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>awscli</code></h1>
<h2 id="ecr-로그인하기" style="position:relative;"><a href="#ecr-%EB%A1%9C%EA%B7%B8%EC%9D%B8%ED%95%98%EA%B8%B0" aria-label="ecr 로그인하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ECR 로그인하기</h2>
<pre><code class="language-bash">aws ecr get-login-password --region &#x3C;REGION> | docker login --username AWS --password-stdin &#x3C;AWS_ACCOUNT_ID>.dkr.ecr.&#x3C;REGION>.amazonaws.com
</code></pre>
<p><code>REGION</code>: 서울 리전이라면 <code>ap-northeast-2</code></p>
<p><code>AWS_ACCOUNT_ID</code> 구하기:</p>
<pre><code class="language-bash">aws sts get-caller-identity
</code></pre>
<p><code>Account</code> 필드의 값이 <code>AWS_ACCOUNT_ID</code> 이다.</p>
<p>e.g. account id = <code>1234</code>, region = <code>ap-northeast-2</code>:</p>
<pre><code class="language-bash">aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin 1234.dkr.ecr.ap-northeast-2.amazonaws.com
</code></pre>
<p>ref:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html">https://docs.aws.amazon.com/AmazonECR/latest/userguide/getting-started-cli.html</a></li>
<li><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/console_account-alias.html">https://docs.aws.amazon.com/IAM/latest/UserGuide/console_account-alias.html</a></li>
</ul>
<h2 id="iam-관련" style="position:relative;"><a href="#iam-%EA%B4%80%EB%A0%A8" aria-label="iam 관련 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IAM 관련</h2>
<p><a href="https://docs.aws.amazon.com/cli/latest/reference/iam/change-password.html">비밀번호 변경</a>(응답 메시지 없음):<br>
<code>aws iam change-password --old-password &#x3C;OLD_PASSWORD> --new-password &#x3C;NEW_PASSWORD></code></p>
<p><a href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_credentials_access-keys.html#rotating_access_keys_cli">Access Key 교체</a></p>
<p>플로우가 조금 복잡하다. 새 access key 생성 -> 새 access key로 도구 업데이트 -> 기존 access key 비활성화 순서로 진행한다.</p>
<p>기존 access key는 비활성화만 하고 나중에 직접 삭제하자.</p>
<ol>
<li><a href="https://docs.aws.amazon.com/cli/latest/reference/iam/create-access-key.html">새 access key 생성</a>:\</li>
</ol>
<p>foreground로 읽으니 파일로 저장하자.</p>
<pre><code class="language-sh">aws iam create-access-key > access-key.json
</code></pre>
<ol start="2">
<li><a href="https://docs.aws.amazon.com/cli/latest/reference/configure/">새 access key로 도구 업데이트</a>:</li>
</ol>
<pre><code class="language-sh">aws configure
</code></pre>
<ol start="3">
<li><a href="https://docs.aws.amazon.com/cli/latest/reference/iam/update-access-key.html">기존 access key 비활성화</a>:</li>
</ol>
<pre><code class="language-sh">aws iam update-access-key --access-key-id &#x3C;OLD_ACCESS_KEY_ID> --status Inactive
</code></pre>
<p>2번에서 <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/configure/import.html">aws configure cli</a> 명으로로 <code>--csv</code> 포맷의 파일을 읽어서 업데이트 할 수 있다.
그러면 interactive로 secret key를 입력하지 않고 자동화할 수 있을 듯한데, 1번의 생성 명령어에서 csv 포맷을 제공하지 않는다.</p>
<p>기존 access-key를 확인하려면 <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/list-access-keys.html">list-access-keys</a>를 사용하면 된다:</p>
<pre><code class="language-sh">aws iam list-access-keys
</code></pre>
<h1 id="localstack" style="position:relative;"><a href="#localstack" aria-label="localstack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LocalStack</h1>
<p><a href="https://github.com/localstack/localstack">https://github.com/localstack/localstack</a></p>
<p>로컬 환경에서 AWS 클라우드 스택을 구축하는 도구이다.</p>
<p>클라우드 기능을 사용하면 의존 때문에 개발 환경을 구축하기 쉽지 않다.
서비스에 가입하거나 비용을 지불하기엔 개발하기 너무 가혹하다.</p>
<p>LocalStack은 AWS 기능 대부분을 제공한다. <a href="https://docs.localstack.cloud/references/coverage/">https://docs.localstack.cloud/references/coverage/</a> 여기에서 어떤 기능을 커버하는지 확인할 수 있는데, 왠만한 서비스는 다 있는 것으로 보인다.</p>
<p>도커로 실행하면 더 쉽다. 저장소의 <a href="https://github.com/localstack/localstack/blob/master/docker-compose.yml">docker-compose.yml</a> 확인하고 그대로 사용해도 된다.</p>
<p>Kinesis를 사용하기 위해서 다음과 같이 사용하고 있다:</p>
<pre><code class="language-yml">version: "3.8"

services:
  localstack:
    image: localstack/localstack
    ports:
      - "127.0.0.1:4566:4566"
      - "127.0.0.1:4510-4559:4510-4559"
    environment:
      - DEBUG=1
      - DOCKER_HOST=unix:///var/run/docker.sock
    volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
      - "./data:/var/lib/localstack"
      - "./kinesis-my-stream.sh:/etc/localstack/init/ready.d/kinesis-my-stream.sh"
</code></pre>
<p>다른 점은 볼륨의 마지막 부분인데, hook을 통해서 스트림을 생성하도록 했다:</p>
<pre><code class="language-bash">#!/bin/bash

aws --endpoint-url=http://localhost:4566 kinesis create-stream --stream-name my-event-dev --shard-count 1 --region ap-northeast-2
aws --endpoint-url=http://localhost:4566 kinesis list-streams --region ap-northeast-2
</code></pre>
<p>hook에 대해선 다음 문서에서 설명한다:<br>
<a href="https://docs.localstack.cloud/references/init-hooks/">https://docs.localstack.cloud/references/init-hooks/</a></p>
<p>위 예시에서 보듯이 <code>aws</code> 명령어가 LocalStack과 잘 호환된다.
<code>--endpoint-url</code>을 통해서 LocalStack와 통신한다.
<code>awslocal</code> 명령어도 제공하는데, endpoint를 명시하지 않아도 된다.</p>
<p>credentials 관련 오류가 있으면 <code>awslocal</code> 명령을 사용하자. 그러면 credentials(<code>~/.aws/credentials</code>)을 확인하지 않는다.
앱에서 접근해야 한다면 <code>awslocal</code>을 사용할 수 없으니, 임의로 넣어놓자:</p>
<pre><code class="language-text">[default]
aws_access_key_id = test
aws_secret_access_key = test
</code></pre>
<p>환경 변수를 사용해도 된다:</p>
<pre><code>AWS_ACCESS_KEY_ID = test
AWS_SECRET_ACCESS_KEY = test
</code></pre>
<p>검증은 localstack이 넘길테니 임의로 넣어두면 클라이언트 단에서 credentials 존재 여부 정도만 확인하니 괜찮다.</p>
<h1 id="kinesis" style="position:relative;"><a href="#kinesis" aria-label="kinesis permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kinesis</h1>
<p>Consumer 라이브러리를 KCL(Kinesis Client Library)라고 부르고,
Producer 라이브러리를 KPL(Kinesis Producer Library)라고 부른다.
문서 설명이 모두 이 약자로 설명하고 있기 때문에 알아두는 편이 좋다.</p>
<p><a href="https://docs.aws.amazon.com/streams/latest/dev/shared-throughput-kcl-consumers.html#shared-throughput-kcl-consumers-concepts">KCL 개념 - AWS Document</a></p>
<p>KCL은 Shard의 체크포인트를 표시하기 위해 DynamoDB를 사용한다.
따라서 Kinesis, DynamoDB 두 개의 AWS 서비스를 사용해야 한다.</p>
<p>AWS 공식 예제는 <a href="https://docs.aws.amazon.com/streams/latest/dev/kcl2-standard-consumer-java-example.html">KCL 2.0 for Java</a>나
<a href="https://github.com/awslabs/amazon-kinesis-client/blob/master/amazon-kinesis-client/src/test/java/software/amazon/kinesis/utils/TestRecordProcessor.java">amazon-kinesis-client 저장소의 테스트 코드</a>가 있다.</p>
<p>내 localstack + consumer 예제: <a href="https://github.com/Edunga1/practice-localstack-kinesis">https://github.com/Edunga1/practice-localstack-kinesis</a> <br>
docker-compose로 localstack + consumer를 실행하고, aws cli로 <code>put-record</code>를 통해 데이터를 생성하도록 했다.</p>
<p><strong>push model and pull model</strong></p>
<p><a href="https://docs.aws.amazon.com/streams/latest/dev/developing-consumers-with-sdk.html#kinesis-using-sdk-java-get-data">https://docs.aws.amazon.com/streams/latest/dev/developing-consumers-with-sdk.html#kinesis-using-sdk-java-get-data</a></p>
<blockquote>
<p>The Kinesis Data Streams APIs include the getShardIterator and getRecords methods that you can invoke to retrieve records from a data stream. This is the pull model, where your code draws data records directly from the shards of the data stream.</p>
</blockquote>
<p>Kinesis Data Stream API의 <code>getShardIterator</code>와 <code>getRecords</code>를 사용하면 pull model로 데이터를 가져올 수 있다.</p>
<blockquote>
<p>We recommend that you use the record processor support provided by KCL to retrieve records from your data streams. This is the push model, where you implement the code that processes the data.</p>
</blockquote>
<p>KCL의 record processor를 사용하면 push model로 데이터를 가져올 수 있다.</p>
<h2 id="개념" style="position:relative;"><a href="#%EA%B0%9C%EB%85%90" aria-label="개념 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>개념</h2>
<h3 id="fan-out" style="position:relative;"><a href="#fan-out" aria-label="fan out permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>fan-out</h3>
<p><strong>shared fan-out, enhanced fan-out</strong></p>
<p>consumer의 종류에는 shared fan-out과 enhanced fan-out 두 가지가 있다.</p>
<p><a href="https://aws.amazon.com/kinesis/data-streams/faqs/#Reading_and_processing_data_from_Kinesis_data_streams">Q: What is a consumer, and what are different consumer types offered by Amazon Kinesis Data Streams? - Amazon Kinesis Data Streams FAQs</a></p>
<blockquote>
<p>The shared fan-out consumers all share a shard’s 2 MB/second of read throughput and five transactions per second limits and require the use of the GetRecords API</p>
</blockquote>
<p>shared fan-out은 컨슈머간 공유되며, 초당 2 MB, 초당 5개의 transaction으로 제한된다.
transaction은 <code>GetRecrods</code> API 호출을 의미하는 거 같다.</p>
<blockquote>
<p>An enhanced fan-out consumer gets its own 2 MB/second allotment of read throughput, allowing multiple consumers to read data from the same stream in parallel, without contending for read throughput with other consumers.</p>
</blockquote>
<p>enhanced fan-out은 consumer간 할당량 경쟁하지 않는다.</p>
<p>enhanced fan-out는 seoul region 기준 <a href="https://aws.amazon.com/kinesis/data-streams/pricing/">1GB 당 0.062 비용이 든다</a>고 한다.</p>
<h2 id="자바-외-언어로-kinesis-앱-개발" style="position:relative;"><a href="#%EC%9E%90%EB%B0%94-%EC%99%B8-%EC%96%B8%EC%96%B4%EB%A1%9C-kinesis-%EC%95%B1-%EA%B0%9C%EB%B0%9C" aria-label="자바 외 언어로 kinesis 앱 개발 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자바 외 언어로 Kinesis 앱 개발</h2>
<p>Node.js consumer를 만든다면 <a href="https://github.com/awslabs/amazon-kinesis-client-nodejs/">KCL for Node.js</a>를 사용한다.</p>
<p>주의할 점은 자바 외 언어로 제공하는 KCL은 모두 <a href="https://github.com/awslabs/amazon-kinesis-client">KCL for JAVA</a>을 사용하기 때문에
자바 런타임이 필요하다. <a href="https://github.com/awslabs/amazon-kinesis-client-nodejs/blob/master/bin/kcl-bootstrap">데몬으로 KCL for Java와 통신하도록 구현</a>되어 있다.</p>
<p>Node.js producer는 <a href="https://github.com/awslabs/amazon-kinesis-client-nodejs/">aws-sdk</a>를 사용한다.</p>
<p>LocalStack으로 Node.js consumer는 구현하기 어려워 보인다.
먼저, LocalStack와 커뮤니케이션 하려면 endpoint 설정이 필요한데
KCL 2.0으로 업데이트되면서 <code>kinesisEndpoint</code> <code>dynamodbEndpoint</code> <a href="https://docs.aws.amazon.com/streams/latest/dev/kcl-migration.html#client-configuration-removals">설정이 제거</a>되었다.</p>
<p>Client 생성 주체인 KCL for Node.js에서 진행해야 하지만, 여기엔 설정을 제공하지 않는다. 저장소가 거의 죽어있다.</p>
<p>KCL for Java는 client builder를 통해서 endpoint를 설정할 수 있다. 저장소도 자주 업데이트 된다.</p>
<pre><code class="language-java">KinesisAsyncClient.builder().endpointOverride(URI.create("https://&#x3C;kinesis endpoint>")).build().
</code></pre>
<h1 id="storage-service" style="position:relative;"><a href="#storage-service" aria-label="storage service permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Storage Service</h1>
<p>2021-09-31 AWS CEP 내용 정리한 것.</p>
<p>Storage는 크게 Block, File, Object로 나뉜다.</p>
<ul>
<li>Block: 일반적인 저장소. AWS EBS.</li>
<li>File: NAS 등. AWS EFS, FSx.</li>
<li>Object: AWS S3, Glacier.</li>
</ul>
<h2 id="ebs---elastic-block-storage" style="position:relative;"><a href="#ebs---elastic-block-storage" aria-label="ebs   elastic block storage permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EBS - Elastic Block Storage</h2>
<p>EC2는 OS 등 모든 파일은 네트워크로 연결되는 EBS를 사용한다.</p>
<ul>
<li>EC2의 Instance Store(물리 호스트)도 제공되나, 별도 설정이 필요하고, 사라지는 영역이라서 특정 용도가 아니면 사용되지 않고, 추천하지 않는다.</li>
</ul>
<p><strong>내구성</strong> <br>
AWS에서는 99.999% 신뢰성 제공을 목적으로 설계 되며, 데이터를 잃어버리지 않는 것을 의미</p>
<p>EBS GP2는 Burst 기능을 제공하는데, 유후 시간 후 처음 30분간 3,000 IOPS를 제공하는 기능이다.</p>
<ul>
<li>기본 성능은 3 IOPS/GB 인데, 따라서 1,000GB 이상 볼륨을 사용한다면, Burst 한 것과 같은 성능이므로 Burst 기능을 제공하지 않는다.</li>
<li>GP3은 항상 3,000 IOPS 고정이나, 1TB(1,000GB)를 초과하더라도 3,000 IOPS 그대로다.</li>
</ul>
<p>EBS의 스냅샷은 전체 Copy가 아니라 Incremental을 저장하므로, 스냅샷을 자주 사용하도록 설정하는 것이 좋다.</p>
<h2 id="efs---elastic-file-system" style="position:relative;"><a href="#efs---elastic-file-system" aria-label="efs   elastic file system permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EFS - Elastic File System</h2>
<p>처음부터 얼마나 사용할 지 고민할 필요는 없다. 사용한 만큼 비용 지불. 사용할 때 마다 용량 확장된다.(Scalable)</p>
<h2 id="object-storage" style="position:relative;"><a href="#object-storage" aria-label="object storage permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Object Storage</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/8b70b/aws-object-storage-classes.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVR42q1SS2vbQBDWv/fZtU+2KfjW1yEB99AYEkhDHoWmwXVVnFIXh8aWLGtXj93VY7X7lR05ptDSUwcGffPNzDdiZ7zhYIBer49er4d+v0/u8FPc7XYPHH2ftbnBYIDRaEQ+HA4xHo/R6XTgAUBRFCjLEkop1HUNrTWyLCO+aRri0jSFlBJSKeR5jr/Zer1uBV2TtbZlrT1gS+Fv8VPNvscNdl5VFXFffL8VrLWGNQbGWmgLGGNaIdPAmGaPDUzTHHKwjjc01DSaBBeLBbzdh1Pcv31BRBCEeHlyDZ4Jio9vVziZrQgvA47R+T0yIenf30x/4uz6kXIXtwGOzrb46n+Gl95M8ePda0okm0ecTyZIqQk4mgU49detYCTw/OqB3tEJvppGeP8xbAU/MUwuOL4tfHiVrhFzTgkpBaLtlpbgjLEYWZ4RLkqFON5B64ZizmII0S5nt4sgVQ7fvaEuNJJ4LygEOOcoi4KWk7IEyZZBqxo5y8B3DHo/TAjR1sEiYRxFKjGfzeEhlVARg3YnUpQwVYmGsELFc2QPEZJViGQZQEUJdKlQK4mmLKhHK4lKSKSswuxu3m75f9n35RKeO1h3kEEQ/NM3mw3VhWH4R87xaZLg8vIKvwBT9TOSmFi/IQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="object storage classes"
        title=""
        src="/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/fcda8/aws-object-storage-classes.png"
        srcset="/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/12f09/aws-object-storage-classes.png 148w,
/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/e4a3f/aws-object-storage-classes.png 295w,
/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/fcda8/aws-object-storage-classes.png 590w,
/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/efc66/aws-object-storage-classes.png 885w,
/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/c83ae/aws-object-storage-classes.png 1180w,
/cat-logic/static/929bdee8c8695b2ef4d86667bcedddd3/8b70b/aws-object-storage-classes.png 1266w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>S3 에서 사용하는 스토리지 타입</p>
<p>HOT - COLD는 오브젝트에 접근했을 때 반응에 대한 내용. Observable과 같은 맥락 같다.</p>
<h1 id="networking" style="position:relative;"><a href="#networking" aria-label="networking permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Networking</h1>
<p>2021-09-31 AWS CEP 내용 정리한 것.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/20c85/aws-global-infrastructure.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.1891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgklEQVR42oVSa2+DMAzk//+1ruqHSpX6rZqAVqVQIOT9uMluYRlim6XTBZM4d44LYwwulwvKslxwvzfMdV0vXFUVtNagSCn9ikJKif1+j+PxiMPhgN3uA+fzmb9PpxOu1+tSmC7/LwqlFPq+R9u2zMMwMHddh2ma+NYQAmKMsNZy0RyUE0Is5wtjLNLbRiTEN1OhGOG8h/eeizJi5OIpRaQYWdU4jtySpmlQGGt5kw8BPsQF88G5sHUBxgU4HyC0xa2bGE+hf1qm29dBarX16CeDUVnGY5B4DApNL3HP0AlFJ5bWFNY5pAS2Or/UbH1Zr14S3KRXkLNXDuyosNa9bIUI6wNbI1ukkBS1o8IgDe9Zu9gsmFu2PkK7AGUcJu24WCc0WyfF6xncLCiVgnMeYpLoB8GcNtTMCtOKNxXSommf+KxuKOvbeyy+1VA78h7/qTCEb8uUmKRizmPdvzxopFJ2vlBKw1gHGnB6caU1ZJajOVXaQNN/ymWgb2UMnHM8/MRfrND35iOwNYIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="aws-global-infrastructure"
        title=""
        src="/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/fcda8/aws-global-infrastructure.png"
        srcset="/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/12f09/aws-global-infrastructure.png 148w,
/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/e4a3f/aws-global-infrastructure.png 295w,
/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/fcda8/aws-global-infrastructure.png 590w,
/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/efc66/aws-global-infrastructure.png 885w,
/cat-logic/static/d2c3764a21e8408aecec05b61b17f901/20c85/aws-global-infrastructure.png 999w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Region에는 2개의 Transit이 존재한다. 다른 Region, 외부와의 연결 통로가 된다.</p>
<p>AZ간 통신은 내부망을 통해서만 이루어진다.</p>
<h2 id="주요-네트워킹-서비스" style="position:relative;"><a href="#%EC%A3%BC%EC%9A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%82%B9-%EC%84%9C%EB%B9%84%EC%8A%A4" aria-label="주요 네트워킹 서비스 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>주요 네트워킹 서비스</h2>
<ul>
<li>VPC: AWS 클라우드상에 만드는 가상 네트워크</li>
<li>VPN: On-premise 데이터 센터와 VPC의 IPSec VPN 연결</li>
<li>Direct Connect: On-premise 데이터 센터와 VPC의 전용선 연결</li>
<li>Route 53: 관리형 DNS 서비스</li>
</ul>
<p>AWS에서 자원 레벨은 Global과 Regional으로 나뉜다.
EC2는 Regional 서비스에 포함된다.</p>
<p>AWS에서는 Static의 반대되는 용어로 <code>Elastic</code>을 사용한다.</p>
<h3 id="vpc---virtual-private-cloud" style="position:relative;"><a href="#vpc---virtual-private-cloud" aria-label="vpc   virtual private cloud permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>VPC - Virtual Private Cloud</h3>
<p>독립된 가상 클라우드 네트워크. 나만의 네트워크라고 이해하면 된다.</p>
<p>IP 대역은 CIDR(Classes Inter-Domain Routing) 블록 /16 ~ /28 까지 사용 가능하다.</p>
<p>공인 IP는 비싼 자원이므로 서버 Stop시 해제된다는 등 제약이 있다.</p>
<p>DNS는 기본으로 제공되는 Private, Public DNS가 제공됨</p>
<p><strong>IP 대역</strong> <br>
172.16.0.0/16 CIDR 내에서 네트워크 구성된다.</p>
<p><strong>VPC Peering</strong></p>
<ul>
<li>동일 Region 내 VPC간 네트워크 연결 옵션</li>
<li>VPC간 IP가 중복 불가하며, 하나의 Peering만 제공</li>
</ul>
<h3 id="direct-connect" style="position:relative;"><a href="#direct-connect" aria-label="direct connect permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Direct Connect</h3>
<p>Direct Connect는 물리적으로 전용선으로 연결한다.</p>
<h3 id="route-53" style="position:relative;"><a href="#route-53" aria-label="route 53 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Route 53</h3>
<p>Route53은 FQDN + 다양한 기능을 제공한다.</p></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/wiki/aws/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-9020c94c168332308264.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-75813e24a00d9c44de9f.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-74582c0178aa68d60e79.js\"],\"component---src-pages-wiki-markdown-remark-fields-slug-tsx\":[\"/component---src-pages-wiki-markdown-remark-fields-slug-tsx-5f531581e72418bf5c04.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="c94f88b00d9eeef474f8";</script><script src="/cat-logic/webpack-runtime-5a8ba21bfa25b8d44d01.js" async></script><script src="/cat-logic/framework-3d24f1df4806fe1cdcfc.js" async></script><script src="/cat-logic/app-9020c94c168332308264.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>