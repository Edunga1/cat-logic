<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.14.0"/><style data-href="/cat-logic/styles.7063392de47b3110fc97.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:0 0;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}*{box-sizing:border-box}body{margin:0}</style><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style data-styled="" data-styled-version="5.3.11">.jArVBC{margin:0;padding:1rem 0 .5rem 1rem;font-size:1rem;}/*!sc*/
data-styled.g1[id="Toc__Header-sc-1f76i2s-0"]{content:"jArVBC,"}/*!sc*/
.bJJrFa{box-sizing:border-box;padding:0 1rem 1rem 0;}/*!sc*/
.bJJrFa ul{list-style:none;padding-left:1rem;margin:0;font-size:.8rem;}/*!sc*/
.bJJrFa ul p{margin:0;}/*!sc*/
.bJJrFa a{-webkit-text-decoration:none;text-decoration:none;color:#0D47A1;}/*!sc*/
.bJJrFa a:hover{color:#512DA8;}/*!sc*/
data-styled.g2[id="Toc__Container-sc-1f76i2s-1"]{content:"bJJrFa,"}/*!sc*/
.cnORod{overflow:auto;overflow-wrap:break-word;color:#333333;padding:1.5rem;margin-top:1rem;border-radius:.5rem;border:1px solid rgb(238,238,238);font-family:Arial,Helvetica,sans-serif;}/*!sc*/
.cnORod h1,.cnORod h2,.cnORod h3,.cnORod h4,.cnORod h5,.cnORod h6{margin:1.5rem 0 .8rem;padding-bottom:5px;border-bottom:1px solid #eee;}/*!sc*/
.cnORod h2:not(:first-of-type){margin-top:5rem;}/*!sc*/
.cnORod p{line-height:1.6;}/*!sc*/
.cnORod a:link{color:#0D47A1;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.cnORod a:visited{color:#607AA1;}/*!sc*/
.cnORod a:hover{color:#AF15C0;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.cnORod code:not(pre code){font-size:80%;background-color:#e3e6e8;border-radius:4px;padding:2px 4px;word-break:break-word;}/*!sc*/
.cnORod pre:has(code){font-size:85%;background-color:#f5f5f5;border-radius:.5rem;padding:1rem;overflow:auto;}/*!sc*/
.cnORod img{max-width:100%;}/*!sc*/
.cnORod blockquote{border-left:4px solid #ddd;padding-left:1rem;margin-left:0;font-style:italic;}/*!sc*/
.cnORod table{width:100%;border-collapse:collapse;}/*!sc*/
.cnORod table td,.cnORod table th{padding:.2rem .5rem;}/*!sc*/
.cnORod table thead{background-color:#F5F5F5;}/*!sc*/
.cnORod table tbody{font-size:.8rem;}/*!sc*/
.cnORod table tbody tr:nth-child(even){background-color:#F5F5F5;}/*!sc*/
.cnORod table tbody tr:hover{background-color:#D0D0D0;}/*!sc*/
.cnORod hr{border:none;border-top:1px dashed #aaa;}/*!sc*/
data-styled.g3[id="WikiContent__Container-sc-q3jb6a-0"]{content:"cnORod,"}/*!sc*/
.bUjFDA{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.bUjFDA:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g4[id="Link__A-sc-k1di17-0"]{content:"bUjFDA,"}/*!sc*/
.gcJKrk{padding-top:20rem;}/*!sc*/
data-styled.g5[id="Comments__Container-sc-1ajj4d9-0"]{content:"gcJKrk,"}/*!sc*/
.iTVyYc{width:.5rem;height:.5rem;background-color:rgba(192,222,191,1);}/*!sc*/
.iTVyYc > span{font-size:.5rem;top:1rem;white-space:nowrap;-webkit-transform:rotate(-15deg);-ms-transform:rotate(-15deg);transform:rotate(-15deg);position:inherit;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}/*!sc*/
data-styled.g6[id="GrassPoint__Container-sc-vhet8f-0"]{content:"iTVyYc,"}/*!sc*/
.kTfeIb{height:3rem;overflow:hidden;border-top:1px solid rgba(0,0,0,0.1);border-bottom:1px solid rgba(0,0,0,0.1);padding:0.5rem 0;margin-bottom:1rem;}/*!sc*/
data-styled.g7[id="GrassActivity__Container-sc-1d932e2-0"]{content:"kTfeIb,"}/*!sc*/
.hzZfMw{width:calc(100% - .5rem);height:100%;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g8[id="GrassActivity__PointContainer-sc-1d932e2-1"]{content:"hzZfMw,"}/*!sc*/
.cHXqdT{position:absolute;left:0.00%;z-index:1;}/*!sc*/
.chtdso{position:absolute;left:9.17%;z-index:1;}/*!sc*/
.cxZhon{position:absolute;left:20.86%;z-index:1;}/*!sc*/
.eEmUCO{position:absolute;left:36.73%;z-index:1;}/*!sc*/
.cxYDYA{position:absolute;left:36.86%;z-index:1;}/*!sc*/
.dNTXcB{position:absolute;left:36.87%;z-index:1;}/*!sc*/
.fixxio{position:absolute;left:41.13%;z-index:1;}/*!sc*/
.jTqpkf{position:absolute;left:42.31%;z-index:1;}/*!sc*/
.bkRKzc{position:absolute;left:99.78%;z-index:1;}/*!sc*/
.isrUsa{position:absolute;left:100.00%;z-index:1;}/*!sc*/
data-styled.g9[id="GrassActivity__GrassPointWrapper-sc-1d932e2-2"]{content:"cHXqdT,chtdso,cxZhon,eEmUCO,cxYDYA,dNTXcB,fixxio,jTqpkf,bkRKzc,isrUsa,"}/*!sc*/
.kltskx{font-size:1.5rem;text-align:right;}/*!sc*/
.kltskx a{color:#333333;opacity:0.2;font-weight:700;}/*!sc*/
.kltskx a:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.kltskx a:after{content:"»";margin-left:.1rem;}/*!sc*/
data-styled.g10[id="HomeLink__Container-sc-1f7ngt2-0"]{content:"kltskx,"}/*!sc*/
.fTEgtV{margin:0;padding:1rem 0 .5rem 1rem;font-size:1rem;}/*!sc*/
data-styled.g12[id="RelatedLinks__Header-sc-1y1aimd-1"]{content:"fTEgtV,"}/*!sc*/
.eZRzcg{list-style:none;padding-left:1rem;margin:0;font-size:.8rem;}/*!sc*/
.eZRzcg > li{padding:.1rem 0;line-height:1;display:inline;}/*!sc*/
.eZRzcg > li::after{content:" • ";}/*!sc*/
.eZRzcg > li:last-child::after{content:"";}/*!sc*/
.eZRzcg > li > a:link{color:#0D47A1;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.eZRzcg > li > a:visited{color:#607AA1;}/*!sc*/
.eZRzcg > li > a:hover{color:#AF15C0;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g13[id="RelatedLinks__Links-sc-1y1aimd-2"]{content:"eZRzcg,"}/*!sc*/
.etrcVC{font-size:.7rem;color:#BDBDBD;}/*!sc*/
.etrcVC a{color:#BDBDBD;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g14[id="GitHubCommitLink__Container-sc-13f81rm-0"]{content:"etrcVC,"}/*!sc*/
.cFPWSV{--height-offset:3rem;display:grid;grid-template-areas:"margin main side";padding-top:var(--height-offset);}/*!sc*/
@media (min-width:700px){.cFPWSV{grid-template-columns:0.3fr 3fr 1fr;}}/*!sc*/
data-styled.g15[id="PageLayout__Container-sc-11jfopf-0"]{content:"cFPWSV,"}/*!sc*/
.bXbYGR{display:grid;grid-area:main;width:100%;padding:0 1rem;}/*!sc*/
data-styled.g16[id="PageLayout__Main-sc-11jfopf-1"]{content:"bXbYGR,"}/*!sc*/
.fytAKM{display:none;grid-area:side;grid-area:side;position:-webkit-sticky;position:sticky;top:0;max-height:calc(100vh - var(--height-offset));padding:1rem 1rem;overflow-y:auto;}/*!sc*/
@media (min-width:700px){.fytAKM{display:block;}}/*!sc*/
data-styled.g17[id="PageLayout__Side-sc-11jfopf-2"]{content:"fytAKM,"}/*!sc*/
.eyeBwU{display:none;grid-area:margin;}/*!sc*/
@media (min-width:700px){.eyeBwU{display:block;}}/*!sc*/
data-styled.g18[id="PageLayout__Margin-sc-11jfopf-3"]{content:"eyeBwU,"}/*!sc*/
.jIRpDV{overflow:auto;}/*!sc*/
data-styled.g19[id="Wiki__Main-sc-16q9onf-0"]{content:"jIRpDV,"}/*!sc*/
.buAPAA{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1rem 0;gap:0.5rem;}/*!sc*/
data-styled.g20[id="Wiki__TitleContainer-sc-16q9onf-1"]{content:"buAPAA,"}/*!sc*/
.gysHks{margin:0;font-size:1.5rem;font-weight:700;color:#333333;}/*!sc*/
data-styled.g21[id="Wiki__Title-sc-16q9onf-2"]{content:"gysHks,"}/*!sc*/
.keieWK{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}/*!sc*/
data-styled.g22[id="Wiki__TitleBottom-sc-16q9onf-3"]{content:"keieWK,"}/*!sc*/
.ewPrf{display:block;}/*!sc*/
@media (min-width:700px){.ewPrf{display:none;}}/*!sc*/
data-styled.g23[id="Wiki__TocMain-sc-16q9onf-4"]{content:"ewPrf,"}/*!sc*/
.chvTXK{margin-top:1rem;max-width:20rem;}/*!sc*/
data-styled.g24[id="Wiki__TocSide-sc-16q9onf-5"]{content:"chvTXK,"}/*!sc*/
</style><link rel="sitemap" type="application/xml" href="/cat-logic/sitemap-index.xml"/><link rel="icon" href="/cat-logic/favicon-32x32.png?v=8ac5e5872e5245b972f101c92acce617" type="image/png"/><link rel="manifest" href="/cat-logic/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/cat-logic/icons/icon-48x48.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="72x72" href="/cat-logic/icons/icon-72x72.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="96x96" href="/cat-logic/icons/icon-96x96.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="144x144" href="/cat-logic/icons/icon-144x144.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="192x192" href="/cat-logic/icons/icon-192x192.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="256x256" href="/cat-logic/icons/icon-256x256.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="384x384" href="/cat-logic/icons/icon-384x384.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="512x512" href="/cat-logic/icons/icon-512x512.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><title data-gatsby-head="true">Cat Logic - Docker</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="PageLayout__Container-sc-11jfopf-0 cFPWSV"><div class="PageLayout__Margin-sc-11jfopf-3 eyeBwU"></div><div class="PageLayout__Main-sc-11jfopf-1 bXbYGR"><div class="Wiki__Main-sc-16q9onf-0 jIRpDV"><div class="Wiki__TitleContainer-sc-16q9onf-1 buAPAA"><div class="HomeLink__Container-sc-1f7ngt2-0 kltskx"><a href="" class="Link__A-sc-k1di17-0 bUjFDA">CAT</a></div><a href="." class="Link__A-sc-k1di17-0 bUjFDA"><h1 class="Wiki__Title-sc-16q9onf-2 gysHks">Docker</h1></a></div><div class="GrassActivity__Container-sc-1d932e2-0 kTfeIb"><div class="GrassActivity__PointContainer-sc-1d932e2-1 hzZfMw"><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cHXqdT"><span>3/14/2024</span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cHXqdT"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 chtdso"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cxZhon"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 eEmUCO"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cxYDYA"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 dNTXcB"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 fixxio"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 fixxio"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 jTqpkf"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 bkRKzc"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 isrUsa"><span>8/9/2025</span></div></div></div><div class="Wiki__TitleBottom-sc-16q9onf-3 keieWK"><div class="GitHubCommitLink__Container-sc-13f81rm-0 etrcVC"><a href="https://github.com/edunga1/cat-logic/commit/6ecbbc6a63b22d1a30765578aa917fe2a14802f8">8/8/2025, 7:19:37 AM</a></div></div><div class="Wiki__TocMain-sc-16q9onf-4 ewPrf"><h3 class="Toc__Header-sc-1f76i2s-0 jArVBC">Table of Contents</h3><div class="Toc__Container-sc-1f76i2s-1 bJJrFa"><ul>
<li>
<p><a href="#docker">Docker</a></p>
<ul>
<li>
<p><a href="#docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0">Docker 환경 구성하기</a></p>
<ul>
<li>
<p><a href="#docker-desktop">Docker Desktop</a></p>
</li>
<li>
<p><a href="#rancher-desktop">Rancher Desktop</a></p>
</li>
<li>
<p><a href="#colima">Colima</a></p>
<ul>
<li><a href="#%EB%B0%94%EC%9D%B8%EB%94%A9%ED%95%9C-%ED%8F%AC%ED%8A%B8%EB%A1%9C-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%9D%98-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%A0%91%EA%B7%BC%EC%9D%B4-%EC%95%88%EB%90%98%EB%8A%94-%EB%AC%B8%EC%A0%9C">바인딩한 포트로 컨테이너의 네트워크 접근이 안되는 문제</a></li>
</ul>
</li>
<li>
<p><a href="#osx-%EC%97%90%EC%84%9C-%EC%88%98%EB%8F%99%EC%9C%BC%EB%A1%9C-docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0">OSX 에서 수동으로 Docker 환경 구성하기</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#dockerfile%EC%9D%98-volume-%EB%AA%85%EB%A0%B9%EC%96%B4">Dockerfile의 Volume 명령어</a></p>
</li>
<li>
<p><a href="#dockerfile">Dockerfile</a></p>
<ul>
<li><a href="#%EB%AA%85%EB%A0%B9%EC%96%B4">명령어</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%A4%91%EC%A7%80%EB%90%9C-%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90%EC%84%9C-%ED%8C%8C%EC%9D%BC-%EB%B3%B5%EC%82%AC%ED%95%98%EA%B8%B0">중지된 도커 컨테이너에서 파일 복사하기</a></p>
</li>
<li>
<p><a href="#hostdockerinternal%EB%A1%9C-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%91%EA%B7%BC%ED%95%98%EA%B8%B0"><code class="language-text">host.docker.internal</code>로 호스트 서비스 접근하기</a></p>
<ul>
<li><a href="#%EB%8C%80%EC%B2%B4%EB%8A%94">대체는?</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%97%90%EB%9F%AC">에러</a></p>
<ul>
<li><a href="#docker-request-returned-bad-gateway-for-api-route-and-version">"docker: request returned Bad Gateway for API route and version"</a></li>
<li><a href="#no-matching-manifest-for-linuxarm64v8-in-the-manifest-list-entries">"no matching manifest for linux/arm64/v8 in the manifest list entries"</a></li>
</ul>
</li>
<li>
<p><a href="#%ED%99%95%EC%9D%B8%EC%A4%91%EC%9D%B8-%EB%AC%B8%EC%A0%9C">확인중인 문제</a></p>
<ul>
<li><a href="#wsl2%EC%97%90%EC%84%9C-nvidia-gpu-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">WSL2에서 Nvidia GPU 사용하기</a></li>
</ul>
</li>
<li>
<p><a href="#references">References</a></p>
</li>
</ul>
</li>
</ul></div></div><div class="WikiContent__Container-sc-q3jb6a-0 cnORod">
<p>운영체제 수준 가상화 컨테이너 관리 도구.</p>
<p><a href="../podman">podman</a>의 선택지도 있다.
docker 명령어와 호환된다. 다만 WSL에서는 리소스 설정을 할 수 없어서 사용하지 않는다.</p>
<h2 id="docker-환경-구성하기" style="position:relative;"><a href="#docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0" aria-label="docker 환경 구성하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker 환경 구성하기</h2>
<p>여러가지 선택지가 있으나 MacOS, Linux라면 Colima를 가장 추천한다.
WSL2는 Rancher Desktop 추천.</p>
<h3 id="docker-desktop" style="position:relative;"><a href="#docker-desktop" aria-label="docker desktop permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker Desktop</h3>
<p><a href="https://www.docker.com/products/docker-desktop/">https://www.docker.com/products/docker-desktop/</a></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">brew <span class="token function">install</span> <span class="token parameter variable">--cask</span> <span class="token function">docker</span></code></pre></div>
<p>가장 쉽게 Docker를 사용할 수 있는 방법이다.
개인 사용자는 무료로 사용할 수 있다.
라이센스 정책 변경으로 인해 <a href="https://www.docker.com/pricing/faq/">기업 사용자는 조건</a>에 따라 유료로 사용해야 한다.</p>
<h3 id="rancher-desktop" style="position:relative;"><a href="#rancher-desktop" aria-label="rancher desktop permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rancher Desktop</h3>
<p><a href="https://rancherdesktop.io/">https://rancherdesktop.io/</a></p>
<p><strong>설치</strong></p>
<p>MacOS:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">brew <span class="token function">install</span> <span class="token parameter variable">--cask</span> rancher</code></pre></div>
<p>WSL:</p>
<div class="gatsby-highlight" data-language="powershell"><pre class="language-powershell"><code class="language-powershell">winget install rancher-desktop</code></pre></div>
<p>Docker Desktop과 흡사하다. 기본적으로 <a href="../kubernetes">k8s</a> 제공한다.
불필요 하다면 끄는 편이 리소스 절약에 좋다.
container runtime을 containerd, dockerd 중 선택할 수 있는데, docker에 익숙하면 dockerd를 선택하는 것이 좋다.</p>
<p>개인 사용자더라도 docker desktop의 라이센스 정책이 불편하니 그냥 rancher desktop을 사용하는 것이 좋을지도.</p>
<p>WSL2을 잘 지원한다.</p>
<p><code class="language-text">rdctl</code> 명령어를 제공한다.</p>
<p>다음과 같이 시작할 수 있다: <code class="language-text">rdctl start --path /mnt/c/Program\ Files/Rancher\ Desktop/Rancher\ Desktop.exe</code></p>
<p><code class="language-text">--path</code> 옵션이 필수는 아닌 거 같지만, 내 경우는 찾지 못했다. 그래서 실행 파일로 시작하는 것과 비교해서 별다른 장정이 없다.</p>
<p>종료는 그래도 편할 수도 있겠다: <code class="language-text">rdctl shutdown</code></p>
<h3 id="colima" style="position:relative;"><a href="#colima" aria-label="colima permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Colima</h3>
<p><a href="https://github.com/abiosoft/colima/">https://github.com/abiosoft/colima/</a></p>
<p>Linux, MacOS 모두 지원한다.
최소한의 설정으로 컨테이너를 제공한다고 설명한다:</p>
<blockquote>
<p>Container runtimes on macOS (and Linux) with minimal setup</p>
</blockquote>
<p><a href="../mac-os#homebrew-%EB%A7%A5%EC%9A%A9-%ED%8C%A8%ED%82%A4%EC%A7%80-%EA%B4%80%EB%A6%AC%EC%9E%90">Homebrew</a>로 쉽게 설치할 수 있다: <code class="language-text">brew install colima</code></p>
<p><a href="https://github.com/abiosoft/colima/issues/434">아직 WSL2를 지원하지 않으니</a> 주의.
<a href="https://github.com/lima-vm/">Lima</a>라는 가상머신 지원 도구를 사용하는데, 아직 윈도우를 지원하지 않아서 colima도 제공할 수 없다는 듯. 조만간 WSL도 제공할 수 있을 거 같다고 하니 기다려 보자.</p>
<p>Command line으로만 도커를 시작할 수 있다.
GUI를 제공하지 않지만 Docker Desktop이나 Rancher Desktop에서도 GUI를 잘 사용하지 않으니 딱히 문제는 안된다.</p>
<p><code class="language-text">colima</code> 명령어를 제공하고, <code class="language-text">colima start</code>로 도커를 시작한다.
다만 기본으로 memory가 2GiB로 설정되는데 이는 특정 도커 이미지를 사용할 때 예기치 않은 문제를 일으킬 수 있다.
내 경우 메모리 문제로 <a href="https://github.com/marclamberti/docker-airflow/blob/main/docker-compose.yml">airflow 컨테이너</a>가 시작하자마자 죽는 문제가 있었다.</p>
<p>가상 환경의 리소스를 늘리려면 시작 시 인자로 넘긴다.  <code class="language-text">colima start --memory 8 --cpu 4</code></p>
<ul>
<li><code class="language-text">--memory</code>: 메모리 크기, GiB 단위로 지정</li>
<li><code class="language-text">--cpu</code>: CPU 코어 수, 기본값은 2</li>
<li><code class="language-text">--disk</code>: 디스크 크기, GiB 단위로 지정, 기본값은 60GiB
<ul>
<li>Docker 컨테이너 에러로 <code class="language-text">no space left on device</code>가 발생한다면 디스크 크기를 늘려보자.</li>
</ul>
</li>
</ul>
<p>현재 자원 할당 상태를 보려면 <code class="language-text">colima status -e</code>를 입력하자.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">❯ colima status <span class="token parameter variable">-e</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> colima is running using QEMU
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> arch: aarch64
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> runtime: <span class="token function">docker</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> mountType: sshfs
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> socket: unix:///Users/alleb/.colima/default/docker.sock
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> networkDriver: gvproxy
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> cpu: <span class="token number">2</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> mem: 8GiB
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> disk: 60GiB</code></pre></div>
<h4 id="바인딩한-포트로-컨테이너의-네트워크-접근이-안되는-문제" style="position:relative;"><a href="#%EB%B0%94%EC%9D%B8%EB%94%A9%ED%95%9C-%ED%8F%AC%ED%8A%B8%EB%A1%9C-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%9D%98-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%A0%91%EA%B7%BC%EC%9D%B4-%EC%95%88%EB%90%98%EB%8A%94-%EB%AC%B8%EC%A0%9C" aria-label="바인딩한 포트로 컨테이너의 네트워크 접근이 안되는 문제 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>바인딩한 포트로 컨테이너의 네트워크 접근이 안되는 문제</h4>
<p><code class="language-text">docker ps</code>로 포트 바인딩을 확인되는데도, <code class="language-text">localhost:포트</code>로 액세스할 수 없는 경우가 종종 발생한다.</p>
<p>docker-desktop 등 다른 도구에서는 그런적이 없었던 거 같은데, colima 사용하면서, 재시작하지 않고 오래 사용하면 발생하는 거 같기도 하다.</p>
<p>어쨌든 <code class="language-text">colima stop</code>으로 중지하고 다시 <code class="language-text">colima start</code>로 재시작하면 해결되었다. <code class="language-text">colima restart</code>는 안되었다.</p>
<p><a href="https://github.com/abiosoft/colima/issues/71#issuecomment-1048749674">Colima 이슈</a>에 비슷한 내용으로 등록된 것도 있는데,
내 경우는 colima를 시작하지 얼마 안된 경우에는 발생하지 않았다는 점에서 좀 다르다. 이슈어는 방금 시작한 후 포트가 활성화되지 않았다고 한다.<br>
리액션이 가장 많은 답변은 <code class="language-text">docker.sock</code>이 오래된 파일을 가르키고 있어서 발생했고, symlink를 새로 만들어서 해결했다고 한다.</p>
<blockquote>
<p>Solved it by removing the old symlink and then sudo ln -s /Users/$USER/.colima/docker.sock /var/run/docker.sock.</p>
</blockquote>
<h3 id="osx-에서-수동으로-docker-환경-구성하기" style="position:relative;"><a href="#osx-%EC%97%90%EC%84%9C-%EC%88%98%EB%8F%99%EC%9C%BC%EB%A1%9C-docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0" aria-label="osx 에서 수동으로 docker 환경 구성하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>OSX 에서 수동으로 Docker 환경 구성하기</h3>
<p><strong>docker desktop 또는 rancher desktop이 나와서 이 방법은 비추천.</strong></p>
<p><strong>1. Homebrew로 Docker와 Docker-machine 설치</strong></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ brew <span class="token function">install</span> <span class="token function">docker</span> docker-machine</code></pre></div>
<p>docker-machine: 맥을 마치 Host OS 처럼 사용 할 수 있도록 해주는 프로그램</p>
<p><strong>2. Homebrew로 Virtualbox 설치</strong></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ brew cask <span class="token function">install</span> virtualbox</code></pre></div>
<p>Virtualbox: 가상화 프로그램. 맥에서 docker-machine(Host OS, Linux)을 운영하기 위해서 사용</p>
<p><strong>3. docker-machine 설정</strong></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ docker-machine create <span class="token parameter variable">-d</span> virtualbox default</code></pre></div>
<p>virtualbox driver를 이용하여 <code class="language-text">default</code> 이름의 Docker-machine을 생성</p>
<p>virtualbox에 Docker-machine이 올라간다.</p>
<p><strong>4. 생성한 Docker-machine 활성화</strong></p>
<p>Docker-machine을 생성했지만, 아직 <code class="language-text">docker</code> 명령어를 이용할 수 없다.</p>
<p>Docker-machine을 여러개 관리할 수 있다. 따라서 사용하고자 하는 Docker-machine을 활성화해야 한다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ docker-machine <span class="token function">ls</span>
NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER        ERRORS
default   -        virtualbox   Running   tcp://192.168.99.100:2376           v17.03.0-ce

$ docker-machine <span class="token function">env</span> default
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DOCKER_TLS_VERIFY</span><span class="token operator">=</span><span class="token string">"1"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DOCKER_HOST</span><span class="token operator">=</span><span class="token string">"tcp://192.168.99.100:2376"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DOCKER_CERT_PATH</span><span class="token operator">=</span><span class="token string">"/Users/parkdu/.docker/machine/machines/default"</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DOCKER_MACHINE_NAME</span><span class="token operator">=</span><span class="token string">"default"</span>
<span class="token comment">## Run this command to configure your shell:</span>
<span class="token comment">## eval $(docker-machine env default)</span></code></pre></div>
<p>위 명령어로 <code class="language-text">default</code> Docker-machine의 환경 정보를 알 수 있다.</p>
<p>그리고 마지막 <code class="language-text">eval</code> 명령어로 활성화 할 수 있다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">eval</span> <span class="token variable"><span class="token variable">$(</span>docker-machine <span class="token function">env</span> default<span class="token variable">)</span></span>
$ docker-machine <span class="token function">ls</span>
NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER        ERRORS
default   *        virtualbox   Running   tcp://192.168.99.100:2376           v17.03.0-ce</code></pre></div>
<p>ACTIVE 속성이 <code class="language-text">*</code>로 변경되었다.</p>
<p>이제 맥에서 <code class="language-text">docker</code> 명령어를 사용할 수 있다!</p>
<h2 id="dockerfile의-volume-명령어" style="position:relative;"><a href="#dockerfile%EC%9D%98-volume-%EB%AA%85%EB%A0%B9%EC%96%B4" aria-label="dockerfile의 volume 명령어 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dockerfile의 Volume 명령어</h2>
<p>다음과 같이 컨테이너를 띄우면 <code class="language-text">docker run -ti --rm -v $(pwd):/myvol --name foo ubuntu</code>
현재 디렉토리를 컨테이너와 공유하여 사용할 수 있다.</p>
<p>그런데 <strong>Dockerfile</strong> 내에서 <code class="language-text">VOLUME</code> 키워드를 사용하면 호스트를 지정해 줄 수 없다.</p>
<p>그리고 호스트의 디렉토리를 생략하여 <code class="language-text">-v</code> 옵션을 줄 수 있다: <code class="language-text">docker run -ti --rm -v /myvol --name foo ubuntu</code></p>
<p>이는 컨테이너의 경로만 지정한 것이 된다.</p>
<p><code class="language-text">docker inspect</code>로 보면 호스트의 디렉토리(<code class="language-text">source</code>)는 이상한 곳에 연결되어 있다:</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token property">"Mounts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">"Type"</span><span class="token operator">:</span> <span class="token string">"volume"</span><span class="token punctuation">,</span>
        <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"922a144309641e2cb18e84498b6b3b5f7f55eacd8073b37062b1dc50cc568814"</span><span class="token punctuation">,</span>
        <span class="token property">"Source"</span><span class="token operator">:</span> <span class="token string">"/var/lib/docker/volumes/922a144309641e2cb18e84498b6b3b5f7f55eacd8073b37062b1dc50cc568814/_data"</span><span class="token punctuation">,</span>
        <span class="token property">"Destination"</span><span class="token operator">:</span> <span class="token string">"/myvol"</span><span class="token punctuation">,</span>
        <span class="token property">"Driver"</span><span class="token operator">:</span> <span class="token string">"local"</span><span class="token punctuation">,</span>
        <span class="token property">"Mode"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
        <span class="token property">"RW"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"Propagation"</span><span class="token operator">:</span> <span class="token string">""</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span></code></pre></div>
<p>이건 어디다 어떻게 쓰는가?</p>
<p><strong>컨테이너간 데이터 공유</strong> 위해서 사용한다.</p>
<ol>
<li><code class="language-text">foo</code> 컨테이너를 띄운다:<br></li>
</ol>
<p><code class="language-text">docker run -ti --rm -v /myvol --name foo ubuntu</code></p>
<ol start="2">
<li>그리고 <code class="language-text">foo</code> 컨테이너와 데이터를 함께 사용할 <code class="language-text">bar</code>를 띄운다:<br></li>
</ol>
<p><code class="language-text">docker run -ti --rm --volumes-from foo --name bar ubuntu</code></p>
<ol start="3">
<li><code class="language-text">foo</code>와 <code class="language-text">bar</code> 내에서 볼륨 연결된 디렉토리가 비어있음을 확인한다:<br></li>
</ol>
<p><code class="language-text">ls myvol</code></p>
<ol start="4">
<li><code class="language-text">foo</code>에서 <code class="language-text">text</code> 라는 파일을 생성해본다:<br></li>
</ol>
<p><code class="language-text">touch myvol/text</code></p>
<ol start="5">
<li><code class="language-text">bar</code>에도 <code class="language-text">myvol/text</code> 라는 파일이 생성되었음을 확인한다:<br></li>
</ol>
<p><code class="language-text">ls myvol</code></p>
<p>즉, 호스트 디렉토리 연결 없이 볼륨을 사용한다면 <code class="language-text">--volumes-from</code> 옵션을 사용하는 컨테이너가 있음을 의미한다.</p>
<h2 id="dockerfile" style="position:relative;"><a href="#dockerfile" aria-label="dockerfile permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dockerfile</h2>
<p>도커 이미지를 빌드하기 위한 명령어들을 모아놓은 파일.</p>
<p>스크립트로 이루어져 있기 때문에 이미지를 관리하는 것보다 훨씬 비용이 적게 든다는 장점이 있다.</p>
<p>각 명령어 마다 이전 이미지로부터 새로운 이미지를 생성한다.(Layer)</p>
<h3 id="명령어" style="position:relative;"><a href="#%EB%AA%85%EB%A0%B9%EC%96%B4" aria-label="명령어 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>명령어</h3>
<p><strong>CMD</strong></p>
<p>컨테이너 시작 시 실행 할 명령어</p>
<ul>
<li><code class="language-text">CMD &lt;command></code></li>
<li><code class="language-text">CMD ["executable","param1","param2"]</code></li>
</ul>
<p><strong>RUN</strong></p>
<p>빌드 시 실행할 명령어, 일반적으로 이미지의 환경을 구성하는데 사용한다.</p>
<ul>
<li><code class="language-text">RUN &lt;command></code></li>
<li><code class="language-text">RUN ["executable", "param1", "param2"]</code></li>
<li><code class="language-text">RUN apt-get install -y nodejs</code></li>
</ul>
<p><strong>ENV</strong></p>
<p>환경 변수 설정. RUN, CMD 명령어 모두에서 영향을 받는다.</p>
<ul>
<li><code class="language-text">ENV &lt;key> &lt;value></code></li>
<li><code class="language-text">ENV &lt;key>=&lt;value></code></li>
</ul>
<p><strong>WORKDIR</strong></p>
<p>작업 디렉토리 설정. RUN, CMD 명령어의 실행 위치를 설정한다.</p>
<ul>
<li><code class="language-text">WORKDIR &lt;path></code></li>
</ul>
<p><a href="https://docs.docker.com/engine/reference/builder/#add">ADD</a> or <a href="https://docs.docker.com/engine/reference/builder/#copy">COPY</a></p>
<p>호스트의 파일을 이미지에 추가.</p>
<ul>
<li><code class="language-text">ADD &lt;src> &lt;dest></code></li>
<li><code class="language-text">ADD &lt;git ref> &lt;dir></code> git 저장소에서 파일을 가져온다.</li>
</ul>
<p><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#add-or-copy">ADD와 COPY 차이점</a>:</p>
<blockquote>
<p>Although ADD and COPY are functionally similar, generally speaking, COPY is preferred. That’s because it’s more transparent than ADD. COPY only supports the basic copying of local files into the container, while ADD has some features (like local-only tar extraction and remote URL support) that are not immediately obvious. Consequently, the best use for ADD is local tar file auto-extraction into the image, as in ADD rootfs.tar.xz /.</p>
</blockquote>
<p>Best Practice 문서에서 설명하기를, 기능 자체는 비슷하나 일반적(파일 복사)으로 <code class="language-text">COPY</code>를 선호한다. 더 명확하기 때문이다.
<code class="language-text">ADD</code>에는 추가 기능이 있는데, tar 파일 압축 해제나 원격 URL 지원, git 저장소를 추가할 수 있다.</p>
<p><a href="https://docs.docker.com/engine/reference/builder/#expose">EXPOSE</a></p>
<blockquote>
<p>The EXPOSE instruction does not actually publish the port. It functions as a type of documentation between the person who builds the image and the person who runs the container, about which ports are intended to be published.</p>
</blockquote>
<p><code class="language-text">EXPOSE</code>는 포트를 실제로 열지 않는다. 이미지 빌드하는 사람과 컨테이너를 실행하는 사람 사이의 문서 역할을 한다.
<code class="language-text">-p</code> 옵션으로 포트를 열거나, docker-compose의 <code class="language-text">ports</code>를 사용하여 포트를 열자.</p>
<p><code class="language-text">EXPOSE</code>를 주면, 컨테이너를 생성하여 <code class="language-text">docker ps</code>로 컨테이너를 확인했을 때 <code class="language-text">PORTS</code> 열에 포트 정보가 표시된다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">CONTAINER ID        IMAGE                          COMMAND                  CREATED             STATUS              PORTS                                                            NAMES
9f8fa8cbf88c        grokzen/redis-cluster:latest   <span class="token string">"/docker-entrypoint.…"</span>   <span class="token number">27</span> minutes ago      Up <span class="token number">27</span> minutes       <span class="token number">5000</span>-5002/tcp, <span class="token number">6379</span>/tcp, <span class="token number">7001</span>-7007/tcp, <span class="token number">0.0</span>.0.0:6379-<span class="token operator">></span><span class="token number">7000</span>/tcp   redis-cluster</code></pre></div>
<p>여기서 <code class="language-text">5000-5002/tcp, 6379/tcp, 7001-7007/tcp</code>는 <code class="language-text">EXPOSE</code>로 명세했지만 호스트와 바인딩되지 않았음을 의미한다.
즉, <code class="language-text">EXPOSE</code>는 포트 대기중을 의미한다.</p>
<h2 id="중지된-도커-컨테이너에서-파일-복사하기" style="position:relative;"><a href="#%EC%A4%91%EC%A7%80%EB%90%9C-%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90%EC%84%9C-%ED%8C%8C%EC%9D%BC-%EB%B3%B5%EC%82%AC%ED%95%98%EA%B8%B0" aria-label="중지된 도커 컨테이너에서 파일 복사하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>중지된 도커 컨테이너에서 파일 복사하기</h2>
<p><code class="language-text">docker ps -a</code>로 중지된 컨테이너가 있다면 그 컨테이너로부터 파일을 호스트로 복사해올 수 있다</p>
<p><code class="language-text">docker cp 컨테이너:경로 호스트경로</code>로 복사한다.<br>
컨테이너와 호스트를 반대로 입력하여 중지된 컨테이너에 파일을 주입할 수도 있을 거 같다.</p>
<p>반면 <code class="language-text">docker exec</code>는 중지된 컨테이너에 접속할 수 없다.</p>
<hr>
<p>ionic으로 빌드를 하고, jarsginer로 서명까지하여 릴리즈 apk를 만드는 도커파일을 작성했다.<br>
그리고 apk를 생성하면 컨테이너는 종료된다.<br>
젠킨스에 등록하여 master 브랜치가 업데이트 될 때마다 apk를 뽑아서, GCP bucket에 업로드하도록 작성했다.<br></p>
<p>처음엔 볼륨을 연결하여 호스트에 생성되도록 했으나 <code class="language-text">mkdir /root/workspace: read-only file system.</code>에러가 뜬다.<br>
젠킨스 slave의 문제인지. 어차피 볼륨으로 뿜어내는 방식이 내키지 않아서 다른 방식을 찾았다.<br>
무한 루프를 돌도록해서 컨테이너가 죽지 않도록하여 복사해올까 하다가, 중지된 컨테이너에서 가져올 수 있었다.</p>
<p>중지된 컨테이너가 다른 컨테이너에 볼륨을 공유하는 data-only 패턴과 비슷한 방식인듯?</p>
<h2 id="hostdockerinternal로-호스트-서비스-접근하기" style="position:relative;"><a href="#hostdockerinternal%EB%A1%9C-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%91%EA%B7%BC%ED%95%98%EA%B8%B0" aria-label="hostdockerinternal로 호스트 서비스 접근하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">host.docker.internal</code>로 호스트 서비스 접근하기</h2>
<p><code class="language-text">host.docker.internal</code>은 호스트의 ip를 가르키는 DNS name이다.
<a href="https://docs.docker.com/desktop/networking/#i-want-to-connect-from-a-container-to-a-service-on-the-host">container에서 호스트의 서비스에 접근</a>이 필요할 때 사용한다.</p>
<blockquote>
<p>This is for development purpose and does not work in a production environment outside of Docker Desktop.</p>
</blockquote>
<p>주의할 점은 <strong>docker-desktop</strong> 에서 제공하는 것이다. rancher-desktop 등 다른 도구로 docker 구성했다면 사용할 수 없다.</p>
<h3 id="대체는" style="position:relative;"><a href="#%EB%8C%80%EC%B2%B4%EB%8A%94" aria-label="대체는 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>대체는?</h3>
<p><code class="language-text">docker</code> 명령어:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">docker</span> run --add-host<span class="token operator">=</span>host.docker.internal:host-gateway</code></pre></div>
<p><code class="language-text">docker-compose.yml</code>:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">my_app</span><span class="token punctuation">:</span>
  <span class="token key atrule">extra_hosts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"host.docker.internal:host-gateway"</span></code></pre></div>
<p>반드시 <code class="language-text">host.docker.internal</code> 필요는 없다. 편한 것으로 수정하면 된다.</p>
<p><code class="language-text">host-gateway</code>의 정보는 잘 모르겠다. 가상화 도구 중 <code class="language-text">dockerd</code>만 제공하는 것으로 보인다.</p>
<p><code class="language-text">dockerd</code> cli 문서만 있고, 간단하게 설명되어 있다:</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/dockerd/">https://docs.docker.com/engine/reference/commandline/dockerd/</a></p>
<blockquote>
<p>--host-gateway-ip ip
IP address that the special 'host-gateway' string in --add-host resolves to.
Defaults to the IP address of the default bridge</p>
</blockquote>
<h2 id="에러" style="position:relative;"><a href="#%EC%97%90%EB%9F%AC" aria-label="에러 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>에러</h2>
<h3 id="docker-request-returned-bad-gateway-for-api-route-and-version" style="position:relative;"><a href="#docker-request-returned-bad-gateway-for-api-route-and-version" aria-label="docker request returned bad gateway for api route and version permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>"docker: request returned Bad Gateway for API route and version"</h3>
<p>환경은 WSL2 + Rancher Desktop.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker</span> run <span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/root/godot <span class="token parameter variable">-v</span> /tmp:/root/output godot-android godot <span class="token parameter variable">-v</span> --export-debug Android /root/output/MyApp.apk
docker: request returned Bad Gateway <span class="token keyword">for</span> API route and version http://%2Fvar%2Frun%2Fdocker.sock/v1.45/containers/7814b7e6b2291abd01cffcaa8c4de37f39e5d9507289cd7b2ea68e161516b633/start, check <span class="token keyword">if</span> the server supports the requested API version.</code></pre></div>
<p><code class="language-text">/tmp</code> 디렉토리를 볼륨으로 연결하면서 발생했다.
다른 디렉토리를 변경하여 해결.</p>
<h3 id="no-matching-manifest-for-linuxarm64v8-in-the-manifest-list-entries" style="position:relative;"><a href="#no-matching-manifest-for-linuxarm64v8-in-the-manifest-list-entries" aria-label="no matching manifest for linuxarm64v8 in the manifest list entries permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>"no matching manifest for linux/arm64/v8 in the manifest list entries"</h3>
<p>환경은 MacOS M series.</p>
<p>다음과 같이 <code class="language-text">docker pull mysql:5.6</code> manifest를 찾을 수 없다며 실패한다:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">❯ <span class="token function">docker</span> pull mysql:5.6
<span class="token number">5.6</span>: Pulling from library/mysql
no matching manifest <span class="token keyword">for</span> linux/arm64/v8 <span class="token keyword">in</span> the manifest list entries</code></pre></div>
<p>docker는 이미지를 다운로드할 때, 호스트의 아키텍처와 일치하는 이미지를 자동으로 찾는다.
M series는 arm 기반이므로 해당 아키텍처의 이미지를 찾지만, 찾을 수 없다는 의미의 에러인 것.</p>
<p>원인은 mysql 8버전 미만은 arm64 용으로 <a href="https://hub.docker.com/r/arm64v8/mysql/">제공하지 않는다</a>.
해결을 위해선 그냥 amd64 것을 사용해도 동작하므로 <code class="language-text">--platform</code> 옵션을 줘서 amd64 것으로 받는다:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">❯ <span class="token function">docker</span> pull <span class="token parameter variable">--platform</span> linux/amd64 mysql:5.6</code></pre></div>
<p>mysql 8부터는 arm64 아키텍처를 지원하므로 <code class="language-text">mysql:8</code>를 사용하는 것도 방법.</p>
<h2 id="확인중인-문제" style="position:relative;"><a href="#%ED%99%95%EC%9D%B8%EC%A4%91%EC%9D%B8-%EB%AC%B8%EC%A0%9C" aria-label="확인중인 문제 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>확인중인 문제</h2>
<h3 id="wsl2에서-nvidia-gpu-사용하기" style="position:relative;"><a href="#wsl2%EC%97%90%EC%84%9C-nvidia-gpu-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" aria-label="wsl2에서 nvidia gpu 사용하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WSL2에서 Nvidia GPU 사용하기</h3>
<p>Docker와 GPU 모두 잘 모르므로 일단 관련 정보만 좀 수집하자.</p>
<p>해결하고자 하는 문제는 WSL2에서 GPU(Nvidia 사용중)를 사용하는 것이다.</p>
<p>docker는 <code class="language-text">--gpus</code> 옵션으로 GPU를 사용할 수 있다. 하지만 내 경우에는 다음과 같은 에러가 발생했다:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--gpus</span><span class="token operator">=</span>all <span class="token parameter variable">-v</span> ollama:/root/.ollama <span class="token parameter variable">-p</span> <span class="token number">11434</span>:11434 <span class="token parameter variable">--name</span> ollama ollama/ollama
f94d6b2f2858892727c28c259e4d224b7f53414efa198d89e72bb06825cbeab6
docker: Error response from daemon: could not <span class="token keyword">select</span> device driver <span class="token string">""</span> with capabilities: <span class="token punctuation">[</span><span class="token punctuation">[</span>gpu<span class="token punctuation">]</span><span class="token punctuation">]</span>.</code></pre></div>
<p>ollama는 LLM을 사용하기 쉽게 해주는 도구. GPU로 향상된 성능을 이용하고 싶었다.</p>
<hr>
<p>Nvidia 공식 WSL2 지원 문서:<br>
<a href="https://docs.nvidia.com/cuda/wsl-user-guide/index.html">https://docs.nvidia.com/cuda/wsl-user-guide/index.html</a></p>
<p>위 링크는 <a href="https://github.com/NVIDIA/nvidia-docker/issues/1034#issuecomment-703102098">nvidia-docker 이슈</a>의 덧글에서 얻는 정보다.</p>
<blockquote>
<p>Note that NVIDIA Container Toolkit does not yet support Docker Desktop WSL 2 backend.</p>
</blockquote>
<p>2020년 10월에는 위 문구가 있었나 본데, 2024년 2월에는 해당 문구가 없어졌다. 지원하는 건가?</p>
<hr>
<p>GPU 지원 여부를 확인하려면:<br>
<code class="language-text">docker run -it --gpus=all --rm nvidia/cuda:11.4.2-base-ubuntu20.04 nvidia-smi</code></p>
<p><a href="https://www.docker.com/blog/wsl-2-gpu-support-for-docker-desktop-on-nvidia-gpus/">WSL 2 GPU Support for Docker Desktop on NVIDIA GPUs</a> 글에선 다음과 같이 응답한다:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--gpus</span><span class="token operator">=</span>all <span class="token parameter variable">--rm</span> nvidia/cuda:11.4.2-base-ubuntu20.04 nvidia-smi
Tue Dec  <span class="token number">7</span> <span class="token number">13</span>:25:19 <span class="token number">2021</span>
+-----------------------------------------------------------------------------+
<span class="token operator">|</span> NVIDIA-SMI <span class="token number">510.00</span>       Driver Version: <span class="token number">510.06</span>       CUDA Version: <span class="token number">11.6</span>     <span class="token operator">|</span>
<span class="token operator">|</span>-------------------------------+----------------------+----------------------+
<span class="token operator">|</span> GPU  Name        Persistence-M<span class="token operator">|</span> Bus-Id        Disp.A <span class="token operator">|</span> Volatile Uncorr. ECC <span class="token operator">|</span>
<span class="token operator">|</span> Fan  Temp  Perf  Pwr:Usage/Cap<span class="token operator">|</span>         Memory-Usage <span class="token operator">|</span> GPU-Util  Compute M. <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>               MIG M. <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">+=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>   <span class="token number">0</span>  NVIDIA GeForce <span class="token punctuation">..</span>.  On   <span class="token operator">|</span> 00000000:01:00.0 Off <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
<span class="token operator">|</span> N/A    0C    P0    13W /  N/A <span class="token operator">|</span>    132MiB /  4096MiB <span class="token operator">|</span>     N/A      Default <span class="token operator">|</span>
<span class="token operator">|</span>                               <span class="token operator">|</span>                      <span class="token operator">|</span>                  N/A <span class="token operator">|</span>
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
<span class="token operator">|</span> Processes:                                                                  <span class="token operator">|</span>
<span class="token operator">|</span>  GPU   GI   CI        PID   Type   Process name                  GPU Memory <span class="token operator">|</span>
<span class="token operator">|</span>        ID   ID                                                   Usage      <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">|</span>
<span class="token operator">|</span>  No running processes found                                                 <span class="token operator">|</span>
+-----------------------------------------------------------------------------</code></pre></div>
<p>반면에 나는 제대로된 응답을 받지 못한다:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ <span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--gpus</span><span class="token operator">=</span>all <span class="token parameter variable">--rm</span> nvidia/cuda:11.4.2-base-ubuntu20.04 nvidia-smi
Unable to <span class="token function">find</span> image <span class="token string">'nvidia/cuda:11.4.2-base-ubuntu20.04'</span> locally
docker: Error response from daemon: manifest <span class="token keyword">for</span> nvidia/cuda:11.4.2-base-ubuntu20.04 not found: manifest unknown: manifest unknown.
See <span class="token string">'docker run --help'</span><span class="token builtin class-name">.</span></code></pre></div>
<h2 id="references" style="position:relative;"><a href="#references" aria-label="references permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h2>
<p>NodeJS 어플리케이션의 Dockerizing<br>
<a href="https://nodejs.org/en/docs/guides/nodejs-docker-webapp/">https://nodejs.org/en/docs/guides/nodejs-docker-webapp/</a></p>
<p>WSL 2 GPU Support for Docker Desktop on NVIDIA GPUs<br>
<a href="https://www.docker.com/blog/wsl-2-gpu-support-for-docker-desktop-on-nvidia-gpus/">https://www.docker.com/blog/wsl-2-gpu-support-for-docker-desktop-on-nvidia-gpus/</a></p></div><div class="Comments__Container-sc-1ajj4d9-0 gcJKrk"><hr/><div></div></div></div></div><div class="PageLayout__Side-sc-11jfopf-2 fytAKM"><div class="RelatedLinks__Container-sc-1y1aimd-0 ldECpH Wiki__RelatedLinksSide-sc-16q9onf-6 dStlil"><h3 class="RelatedLinks__Header-sc-1y1aimd-1 fTEgtV">Related</h3><ul class="RelatedLinks__Links-sc-1y1aimd-2 eZRzcg"><li><a href="/./wiki/podman" class="Link__A-sc-k1di17-0 bUjFDA">Podman</a></li><li><a href="/./wiki/windows-subsystem-for-linux" class="Link__A-sc-k1di17-0 bUjFDA">Windows Subsystem for Linux (WSL)</a></li><li><a href="/./wiki/godot" class="Link__A-sc-k1di17-0 bUjFDA">Godot Engine</a></li><li><a href="/./wiki/kubernetes" class="Link__A-sc-k1di17-0 bUjFDA">Kubernetes</a></li><li><a href="/./wiki/web" class="Link__A-sc-k1di17-0 bUjFDA">웹 개발</a></li><li><a href="/./wiki/gatsbyjs" class="Link__A-sc-k1di17-0 bUjFDA">GatsbyJS</a></li><li><a href="/./wiki/tools" class="Link__A-sc-k1di17-0 bUjFDA">개발/비개발 도구</a></li></ul></div><div class="Wiki__TocSide-sc-16q9onf-5 chvTXK"><h3 class="Toc__Header-sc-1f76i2s-0 jArVBC">Table of Contents</h3><div class="Toc__Container-sc-1f76i2s-1 bJJrFa"><ul>
<li>
<p><a href="#docker">Docker</a></p>
<ul>
<li>
<p><a href="#docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0">Docker 환경 구성하기</a></p>
<ul>
<li>
<p><a href="#docker-desktop">Docker Desktop</a></p>
</li>
<li>
<p><a href="#rancher-desktop">Rancher Desktop</a></p>
</li>
<li>
<p><a href="#colima">Colima</a></p>
<ul>
<li><a href="#%EB%B0%94%EC%9D%B8%EB%94%A9%ED%95%9C-%ED%8F%AC%ED%8A%B8%EB%A1%9C-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%9D%98-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%A0%91%EA%B7%BC%EC%9D%B4-%EC%95%88%EB%90%98%EB%8A%94-%EB%AC%B8%EC%A0%9C">바인딩한 포트로 컨테이너의 네트워크 접근이 안되는 문제</a></li>
</ul>
</li>
<li>
<p><a href="#osx-%EC%97%90%EC%84%9C-%EC%88%98%EB%8F%99%EC%9C%BC%EB%A1%9C-docker-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0">OSX 에서 수동으로 Docker 환경 구성하기</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#dockerfile%EC%9D%98-volume-%EB%AA%85%EB%A0%B9%EC%96%B4">Dockerfile의 Volume 명령어</a></p>
</li>
<li>
<p><a href="#dockerfile">Dockerfile</a></p>
<ul>
<li><a href="#%EB%AA%85%EB%A0%B9%EC%96%B4">명령어</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%A4%91%EC%A7%80%EB%90%9C-%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90%EC%84%9C-%ED%8C%8C%EC%9D%BC-%EB%B3%B5%EC%82%AC%ED%95%98%EA%B8%B0">중지된 도커 컨테이너에서 파일 복사하기</a></p>
</li>
<li>
<p><a href="#hostdockerinternal%EB%A1%9C-%ED%98%B8%EC%8A%A4%ED%8A%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%A0%91%EA%B7%BC%ED%95%98%EA%B8%B0"><code class="language-text">host.docker.internal</code>로 호스트 서비스 접근하기</a></p>
<ul>
<li><a href="#%EB%8C%80%EC%B2%B4%EB%8A%94">대체는?</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%97%90%EB%9F%AC">에러</a></p>
<ul>
<li><a href="#docker-request-returned-bad-gateway-for-api-route-and-version">"docker: request returned Bad Gateway for API route and version"</a></li>
<li><a href="#no-matching-manifest-for-linuxarm64v8-in-the-manifest-list-entries">"no matching manifest for linux/arm64/v8 in the manifest list entries"</a></li>
</ul>
</li>
<li>
<p><a href="#%ED%99%95%EC%9D%B8%EC%A4%91%EC%9D%B8-%EB%AC%B8%EC%A0%9C">확인중인 문제</a></p>
<ul>
<li><a href="#wsl2%EC%97%90%EC%84%9C-nvidia-gpu-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">WSL2에서 Nvidia GPU 사용하기</a></li>
</ul>
</li>
<li>
<p><a href="#references">References</a></p>
</li>
</ul>
</li>
</ul></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1L3R7GGF7P"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-1L3R7GGF7P',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-1L3R7GGF7P', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/wiki/docker/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-02e4a52d320788210e93.js\"],\"component---src-components-gatsby-templates-wiki-tsx\":[\"/component---src-components-gatsby-templates-wiki-tsx-e2320a4b5525df8e9238.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-10d51ee2f28b984f9269.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-52da698a32e912a84508.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="0a9cac8a2d68612dda86";</script><script src="/cat-logic/webpack-runtime-9842e5276906fe21193f.js" async></script><script src="/cat-logic/framework-4bfcb0a3c03c938f10bc.js" async></script><script src="/cat-logic/app-02e4a52d320788210e93.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>