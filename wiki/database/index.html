<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.14.0"/><style data-href="/cat-logic/styles.7063392de47b3110fc97.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:0 0;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}*{box-sizing:border-box}body{margin:0}</style><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style data-styled="" data-styled-version="5.3.11">.jArVBC{margin:0;padding:1rem 0 .5rem 1rem;font-size:1rem;}/*!sc*/
data-styled.g1[id="Toc__Header-sc-1f76i2s-0"]{content:"jArVBC,"}/*!sc*/
.bJJrFa{box-sizing:border-box;padding:0 1rem 1rem 0;}/*!sc*/
.bJJrFa ul{list-style:none;padding-left:1rem;margin:0;font-size:.8rem;}/*!sc*/
.bJJrFa ul p{margin:0;}/*!sc*/
.bJJrFa a{-webkit-text-decoration:none;text-decoration:none;color:#0D47A1;}/*!sc*/
.bJJrFa a:hover{color:#512DA8;}/*!sc*/
data-styled.g2[id="Toc__Container-sc-1f76i2s-1"]{content:"bJJrFa,"}/*!sc*/
.kWzErG{overflow:auto;overflow-wrap:break-word;color:#333333;padding:1.5rem;margin-top:1rem;border-radius:.5rem;border:1px solid rgb(238,238,238);font-family:Arial,Helvetica,sans-serif;}/*!sc*/
.kWzErG h1,.kWzErG h2,.kWzErG h3,.kWzErG h4,.kWzErG h5,.kWzErG h6{margin:1.5rem 0 .8rem;padding-bottom:5px;border-bottom:1px solid #eee;}/*!sc*/
.kWzErG h2:not(:first-of-type){margin-top:5rem;}/*!sc*/
.kWzErG h2 a:link{color:#0D47A1;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.kWzErG h2 a:visited{color:#607AA1;}/*!sc*/
.kWzErG h2 a:hover{color:#AF15C0;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
.kWzErG h2 code:not(pre code){font-size:80%;background-color:#e3e6e8;border-radius:4px;padding:2px 4px;word-break:break-word;}/*!sc*/
.kWzErG h2 pre:has(code){font-size:85%;background-color:#f5f5f5;border-radius:.5rem;padding:1rem;overflow:auto;}/*!sc*/
.kWzErG h2 img{max-width:100%;}/*!sc*/
.kWzErG h2 blockquote{border-left:4px solid #ddd;padding-left:1rem;margin-left:0;font-style:italic;}/*!sc*/
.kWzErG h2 table{width:100%;border-collapse:collapse;}/*!sc*/
.kWzErG h2 table td,.kWzErG h2 table th{padding:.2rem .5rem;}/*!sc*/
.kWzErG h2 table thead{background-color:#F5F5F5;}/*!sc*/
.kWzErG h2 table tbody{font-size:.8rem;}/*!sc*/
.kWzErG h2 table tbody tr:nth-child(even){background-color:#F5F5F5;}/*!sc*/
.kWzErG h2 table tbody tr:hover{background-color:#D0D0D0;}/*!sc*/
.kWzErG h2 hr{border:none;border-top:1px dashed #aaa;}/*!sc*/
data-styled.g3[id="WikiContent__Container-sc-q3jb6a-0"]{content:"kWzErG,"}/*!sc*/
.bUjFDA{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.bUjFDA:hover{-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g4[id="Link__A-sc-k1di17-0"]{content:"bUjFDA,"}/*!sc*/
.gcJKrk{padding-top:20rem;}/*!sc*/
data-styled.g5[id="Comments__Container-sc-1ajj4d9-0"]{content:"gcJKrk,"}/*!sc*/
.iTVyYc{width:.5rem;height:.5rem;background-color:rgba(192,222,191,1);}/*!sc*/
.iTVyYc > span{font-size:.5rem;top:1rem;white-space:nowrap;-webkit-transform:rotate(-15deg);-ms-transform:rotate(-15deg);transform:rotate(-15deg);position:inherit;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}/*!sc*/
data-styled.g6[id="GrassPoint__Container-sc-vhet8f-0"]{content:"iTVyYc,"}/*!sc*/
.kTfeIb{height:3rem;overflow:hidden;border-top:1px solid rgba(0,0,0,0.1);border-bottom:1px solid rgba(0,0,0,0.1);padding:0.5rem 0;margin-bottom:1rem;}/*!sc*/
data-styled.g7[id="GrassActivity__Container-sc-1d932e2-0"]{content:"kTfeIb,"}/*!sc*/
.hzZfMw{width:calc(100% - .5rem);height:100%;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g8[id="GrassActivity__PointContainer-sc-1d932e2-1"]{content:"hzZfMw,"}/*!sc*/
.cHXqdT{position:absolute;left:0.00%;z-index:1;}/*!sc*/
.cIJUCZ{position:absolute;left:3.90%;z-index:1;}/*!sc*/
.diXoli{position:absolute;left:4.09%;z-index:1;}/*!sc*/
.cxZhon{position:absolute;left:20.86%;z-index:1;}/*!sc*/
.dDwXLf{position:absolute;left:24.42%;z-index:1;}/*!sc*/
.dxOPvO{position:absolute;left:26.32%;z-index:1;}/*!sc*/
.gOLShS{position:absolute;left:30.64%;z-index:1;}/*!sc*/
.dNTkOW{position:absolute;left:35.87%;z-index:1;}/*!sc*/
.jmFudv{position:absolute;left:55.80%;z-index:1;}/*!sc*/
.eEmWiC{position:absolute;left:76.73%;z-index:1;}/*!sc*/
.isrUsa{position:absolute;left:100.00%;z-index:1;}/*!sc*/
data-styled.g9[id="GrassActivity__GrassPointWrapper-sc-1d932e2-2"]{content:"cHXqdT,cIJUCZ,diXoli,cxZhon,dDwXLf,dxOPvO,gOLShS,dNTkOW,jmFudv,eEmWiC,isrUsa,"}/*!sc*/
.kltskx{font-size:1.5rem;text-align:right;}/*!sc*/
.kltskx a{color:#333333;opacity:0.2;font-weight:700;}/*!sc*/
.kltskx a:hover{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.kltskx a:after{content:"»";margin-left:.1rem;}/*!sc*/
data-styled.g10[id="HomeLink__Container-sc-1f7ngt2-0"]{content:"kltskx,"}/*!sc*/
.fTEgtV{margin:0;padding:1rem 0 .5rem 1rem;font-size:1rem;}/*!sc*/
data-styled.g12[id="RelatedLinks__Header-sc-1y1aimd-1"]{content:"fTEgtV,"}/*!sc*/
.eZRzcg{list-style:none;padding-left:1rem;margin:0;font-size:.8rem;}/*!sc*/
.eZRzcg > li{padding:.1rem 0;line-height:1;display:inline;}/*!sc*/
.eZRzcg > li::after{content:" • ";}/*!sc*/
.eZRzcg > li:last-child::after{content:"";}/*!sc*/
.eZRzcg > li > a:link{color:#0D47A1;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.eZRzcg > li > a:visited{color:#607AA1;}/*!sc*/
.eZRzcg > li > a:hover{color:#AF15C0;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g13[id="RelatedLinks__Links-sc-1y1aimd-2"]{content:"eZRzcg,"}/*!sc*/
.etrcVC{font-size:.7rem;color:#BDBDBD;}/*!sc*/
.etrcVC a{color:#BDBDBD;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g14[id="GitHubCommitLink__Container-sc-13f81rm-0"]{content:"etrcVC,"}/*!sc*/
.cFPWSV{--height-offset:3rem;display:grid;grid-template-areas:"margin main side";padding-top:var(--height-offset);}/*!sc*/
@media (min-width:700px){.cFPWSV{grid-template-columns:0.3fr 3fr 1fr;}}/*!sc*/
data-styled.g15[id="PageLayout__Container-sc-11jfopf-0"]{content:"cFPWSV,"}/*!sc*/
.bXbYGR{display:grid;grid-area:main;width:100%;padding:0 1rem;}/*!sc*/
data-styled.g16[id="PageLayout__Main-sc-11jfopf-1"]{content:"bXbYGR,"}/*!sc*/
.fytAKM{display:none;grid-area:side;grid-area:side;position:-webkit-sticky;position:sticky;top:0;max-height:calc(100vh - var(--height-offset));padding:1rem 1rem;overflow-y:auto;}/*!sc*/
@media (min-width:700px){.fytAKM{display:block;}}/*!sc*/
data-styled.g17[id="PageLayout__Side-sc-11jfopf-2"]{content:"fytAKM,"}/*!sc*/
.eyeBwU{display:none;grid-area:margin;}/*!sc*/
@media (min-width:700px){.eyeBwU{display:block;}}/*!sc*/
data-styled.g18[id="PageLayout__Margin-sc-11jfopf-3"]{content:"eyeBwU,"}/*!sc*/
.jIRpDV{overflow:auto;}/*!sc*/
data-styled.g19[id="Wiki__Main-sc-16q9onf-0"]{content:"jIRpDV,"}/*!sc*/
.buAPAA{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1rem 0;gap:0.5rem;}/*!sc*/
data-styled.g20[id="Wiki__TitleContainer-sc-16q9onf-1"]{content:"buAPAA,"}/*!sc*/
.gysHks{margin:0;font-size:1.5rem;font-weight:700;color:#333333;}/*!sc*/
data-styled.g21[id="Wiki__Title-sc-16q9onf-2"]{content:"gysHks,"}/*!sc*/
.keieWK{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}/*!sc*/
data-styled.g22[id="Wiki__TitleBottom-sc-16q9onf-3"]{content:"keieWK,"}/*!sc*/
.ewPrf{display:block;}/*!sc*/
@media (min-width:700px){.ewPrf{display:none;}}/*!sc*/
data-styled.g23[id="Wiki__TocMain-sc-16q9onf-4"]{content:"ewPrf,"}/*!sc*/
.chvTXK{margin-top:1rem;max-width:20rem;}/*!sc*/
data-styled.g24[id="Wiki__TocSide-sc-16q9onf-5"]{content:"chvTXK,"}/*!sc*/
</style><link rel="sitemap" type="application/xml" href="/cat-logic/sitemap-index.xml"/><link rel="icon" href="/cat-logic/favicon-32x32.png?v=8ac5e5872e5245b972f101c92acce617" type="image/png"/><link rel="manifest" href="/cat-logic/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/cat-logic/icons/icon-48x48.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="72x72" href="/cat-logic/icons/icon-72x72.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="96x96" href="/cat-logic/icons/icon-96x96.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="144x144" href="/cat-logic/icons/icon-144x144.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="192x192" href="/cat-logic/icons/icon-192x192.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="256x256" href="/cat-logic/icons/icon-256x256.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="384x384" href="/cat-logic/icons/icon-384x384.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="apple-touch-icon" sizes="512x512" href="/cat-logic/icons/icon-512x512.png?v=8ac5e5872e5245b972f101c92acce617"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><title data-gatsby-head="true">Cat Logic - Database</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="PageLayout__Container-sc-11jfopf-0 cFPWSV"><div class="PageLayout__Margin-sc-11jfopf-3 eyeBwU"></div><div class="PageLayout__Main-sc-11jfopf-1 bXbYGR"><div class="Wiki__Main-sc-16q9onf-0 jIRpDV"><div class="Wiki__TitleContainer-sc-16q9onf-1 buAPAA"><div class="HomeLink__Container-sc-1f7ngt2-0 kltskx"><a href="" class="Link__A-sc-k1di17-0 bUjFDA">CAT</a></div><a href="." class="Link__A-sc-k1di17-0 bUjFDA"><h1 class="Wiki__Title-sc-16q9onf-2 gysHks">Database</h1></a></div><div class="GrassActivity__Container-sc-1d932e2-0 kTfeIb"><div class="GrassActivity__PointContainer-sc-1d932e2-1 hzZfMw"><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cHXqdT"><span>7/22/2023</span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cHXqdT"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cIJUCZ"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 diXoli"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 cxZhon"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 dDwXLf"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 dxOPvO"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 gOLShS"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 dNTkOW"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 jmFudv"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 eEmWiC"><span></span></div><div class="GrassPoint__Container-sc-vhet8f-0 iTVyYc GrassActivity__GrassPointWrapper-sc-1d932e2-2 isrUsa"><span>5/26/2025</span></div></div></div><div class="Wiki__TitleBottom-sc-16q9onf-3 keieWK"><div class="GitHubCommitLink__Container-sc-13f81rm-0 etrcVC"><a href="https://github.com/edunga1/cat-logic/commit/584e1677551a2e93dd1eb92c2c9fe73233dc062d">12/20/2024, 9:30:53 AM</a></div></div><div class="Wiki__TocMain-sc-16q9onf-4 ewPrf"><h3 class="Toc__Header-sc-1f76i2s-0 jArVBC">Table of Contents</h3><div class="Toc__Container-sc-1f76i2s-1 bJJrFa"><ul>
<li>
<p><a href="#database">Database</a></p>
<ul>
<li>
<p><a href="#%EC%84%A4%EA%B3%84">설계</a></p>
<ul>
<li>
<p><a href="#%EC%A0%95%EA%B7%9C%ED%99%94-normalization">정규화 (Normalization)</a></p>
<ul>
<li><a href="#%EC%A0%9C-1-%EC%A0%95%EA%B7%9C%ED%99%94-first-normal-form">제 1 정규화 (First Normal Form)</a></li>
<li><a href="#%EC%A0%9C-2-%EC%A0%95%EA%B7%9C%ED%99%94-second-normal-form">제 2 정규화 (Second Normal Form)</a></li>
<li><a href="#%EC%A0%9C-3-%EC%A0%95%EA%B7%9C%ED%99%94-third-normal-form">제 3 정규화 (Third Normal Form)</a></li>
<li><a href="#%EC%97%AD-%EC%A0%95%EA%B7%9C%ED%99%94-denormalization">역 정규화 (Denormalization)</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="#%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%9D%B4%EB%A6%84-%EC%BB%A8%EB%B2%A4%EC%85%98">테이블 이름 컨벤션</a></p>
<ul>
<li><a href="#%EB%8B%A8%EC%88%98-vs-%EB%B3%B5%EC%88%98">단수 vs. 복수</a></li>
</ul>
</li>
<li>
<p><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EB%8A%94-%ED%81%90%EA%B0%80-%EC%95%84%EB%8B%99%EB%8B%88%EB%8B%A4">데이터베이스는 큐가 아닙니다.</a></p>
<ul>
<li><a href="#why-not-a-database">Why not a database?</a></li>
<li><a href="#redis%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%96%B4%EB%96%A8%EA%B9%8C">Redis를 사용하는 것은 어떨까?</a></li>
</ul>
</li>
<li>
<p><a href="#mysql">MySQL</a></p>
<ul>
<li><a href="#mysql-docker-image">MySQL Docker Image</a></li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%82%B4%EC%97%90-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8F%AC%ED%95%A8%ED%95%98%EA%B8%B0">이미지 내에 데이터 포함하기</a></li>
<li><a href="#functional-key-parts">Functional Key Parts</a></li>
<li><a href="#secondary-indexes-and-generated-columns">Secondary Indexes and Generated Columns</a></li>
</ul>
</li>
<li>
<p><a href="#h2-database">H2 Database</a></p>
<ul>
<li><a href="#numberformatexception-for-input-string--%EC%97%90%EB%9F%AC"><code class="language-text">NumberFormatException: for input String: "..."</code> 에러</a></li>
</ul>
</li>
<li>
<p><a href="#postgresql">PostgreSQL</a></p>
</li>
<li>
<p><a href="#realworld-data-dump">Realworld Data Dump</a></p>
</li>
<li>
<p><a href="#sqlite%EC%9D%98-%EC%95%8C%EB%A0%A4%EC%A7%80%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0">SQLite의 알려지지 않은 이야기</a></p>
<ul>
<li><a href="#mcdc-coverage">MC/DC Coverage</a></li>
<li><a href="#do-127b">DO-127B</a></li>
<li><a href="#covering-index">covering index</a></li>
<li><a href="#fossil">Fossil</a></li>
<li><a href="#%EC%9D%B8%EC%83%81%EA%B9%8A%EC%9D%80-%EB%B6%80%EB%B6%84">인상깊은 부분</a></li>
</ul>
</li>
<li>
<p><a href="#scraps">Scraps</a></p>
</li>
</ul>
</li>
</ul></div></div><div class="WikiContent__Container-sc-q3jb6a-0 kWzErG">
<h2 id="설계" style="position:relative;"><a href="#%EC%84%A4%EA%B3%84" aria-label="설계 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설계</h2>
<h3 id="정규화-normalization" style="position:relative;"><a href="#%EC%A0%95%EA%B7%9C%ED%99%94-normalization" aria-label="정규화 normalization permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정규화 (Normalization)</h3>
<p>데이터 중복을 최소화하는 작업</p>
<h4 id="제-1-정규화-first-normal-form" style="position:relative;"><a href="#%EC%A0%9C-1-%EC%A0%95%EA%B7%9C%ED%99%94-first-normal-form" aria-label="제 1 정규화 first normal form permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>제 1 정규화 (First Normal Form)</h4>
<p>inflexible 부분을 제거하는 것이 목적</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">------------------------------------------------------------------------
| name | email           | email2             | email...               |
------------------------------------------------------------------------
| john | apple@gmail.com | banana@hanmail.net |                        |
| paul | cat@gmail.com   | null               |                        |
------------------------------------------------------------------------</code></pre></div>
<p>사용자에 대한 이메일 목록을 관리하고자 할 때, 테이블이 하나라면 <strong>이메일이 추가</strong>되면 컬럼이 늘어나게 된다.</p>
<p>또한 paul은 하나의 이메일을 가지지만 여러개의 메일을 가진 john에 의해 빈 필드를 가져야만 한다.</p>
<p>이 문제를 1:N or N:N 관계로 분리하여 해결하는 것이 제 1 정규화.</p>
<h4 id="제-2-정규화-second-normal-form" style="position:relative;"><a href="#%EC%A0%9C-2-%EC%A0%95%EA%B7%9C%ED%99%94-second-normal-form" aria-label="제 2 정규화 second normal form permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>제 2 정규화 (Second Normal Form)</h4>
<p><strong>Composite Key</strong>를 사용할 때 일반 필드가 Composite Key 중 <strong>일부분</strong>에 의존할 때 문제가 발생한다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">-----------------------------------------------------------------------
| Cours  | Date      | CourseTitle      | Room | Capacity | Available |
-----------------------------------------------------------------------
| SQL101 | 3/1/2013  | SQL Fundamentals | 4A   | 12       | 4         |
| DB202  | 3/1/2013  | Database Design  | 7B   | 14       | 7         |
| SQL101 | 4/14/2013 | SQL Fundamentals | 7B   | 14       | 10        |
| SQL101 | 5/28/2013 | SQL Fundamentals | 12A  | 8        | 8         |
| CS200  | 4/15/2012 | C Programming    | 4A   | 12       | 11        |
-----------------------------------------------------------------------</code></pre></div>
<p>Cours + Date가 <strong>Composite primary key</strong>라고 할 때</p>
<p>CourseTitle은 Course에 <strong>의존된다.</strong></p>
<p>CourseTitle을 Course를 FK, PK로 한 테이블로 분리하여 해결하는 것이 제 2 정규화.</p>
<h4 id="제-3-정규화-third-normal-form" style="position:relative;"><a href="#%EC%A0%9C-3-%EC%A0%95%EA%B7%9C%ED%99%94-third-normal-form" aria-label="제 3 정규화 third normal form permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>제 3 정규화 (Third Normal Form)</h4>
<p>일반 필드가 일반 필드에 의존될 때 발생.</p>
<p>2 정규화와 마찬가지로 테이블로 분리하지만 차이 점은 기존 테이블에서 분리한 테이블을 참조하는 것</p>
<h4 id="역-정규화-denormalization" style="position:relative;"><a href="#%EC%97%AD-%EC%A0%95%EA%B7%9C%ED%99%94-denormalization" aria-label="역 정규화 denormalization permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>역 정규화 (Denormalization)</h4>
<p>특별한 경우 <strong>편리를 위해서</strong> 역정규화를 하기도 한다. 특히 제 3 정규화에서 역정규화를 하는데</p>
<p>예를 들면 Zip code의 경우 State + City에 의해 결정되는데
이를 저장 해 놓으면 서버에서 계산할 수 없는 부분이므로 저장 해 놓으면 단순히 Select 하는 것으로
Zip code를 얻을 수 있기 때문.</p>
<h2 id="테이블-이름-컨벤션" style="position:relative;"><a href="#%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%9D%B4%EB%A6%84-%EC%BB%A8%EB%B2%A4%EC%85%98" aria-label="테이블 이름 컨벤션 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>테이블 이름 컨벤션</h2>
<h3 id="단수-vs-복수" style="position:relative;"><a href="#%EB%8B%A8%EC%88%98-vs-%EB%B3%B5%EC%88%98" aria-label="단수 vs 복수 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단수 vs. 복수</h3>
<p>테이블 이름은 단수로 지어야 하나 복수로 지어야 하나?</p>
<p>코드에서는 리스트인 변수 이름을 지을때는 <code class="language-text">~List</code>와 같은 이름을 피하고 복수형을 사용하고 있다.</p>
<p><a href="https://stackoverflow.com/questions/338156/table-naming-dilemma-singular-vs-plural-names">https://stackoverflow.com/questions/338156/table-naming-dilemma-singular-vs-plural-names</a></p>
<p>링크를 보면 단수, 복수 모두 비등한데. 1200여개의 점수를 얻은 "단수"를 선호하는 두 번째 답변이 와닿는다.(24년 2244점, 첫 번째 이유가 취소선이 그어져있다.)</p>
<p>총 6가지 이유를 가지고 설득하는데 특히 와닿았던 건..</p>
<blockquote>
<p>Reason 1 (Concept). You can think of bag containing apples like "AppleBag", it doesn't matter if contains 0, 1 or a million apples, it is always the same bag. Tables are just that, containers, the table name must describe what it contains, not how much data it contains. Additionally, the plural concept is more about a spoken language one (actually to determine whether there is one or more).</p>
</blockquote>
<p>테이블 이름은 내용(row)을 담고있는 컨테이너를 의미하도록 개념화 한다.
따라서 <em>Apple</em>을 가진 테이블 <em>AppleBag</em>과 같이 이름지을 수 있다.
<em>Apple</em>을 0, 1, 수백만개를 표현할 수 있으므로 적절하다.</p>
<blockquote>
<p>Reason 2. (Convenience). it is easier come out with singular names, than with plural ones. Objects can have irregular plurals or not plural at all, but will always have a singular one (with few exceptions like News).</p>
</blockquote>
<p>모든 단어가 단수와 복수를 구분하지 않기 때문이라는데 이 이유가 가장 와닿는다.
복수형으로 표현한다면 <em>News</em>를 표현하는 테이블 이름은 어떻게 지어야 하나?</p>
<blockquote>
<p>Reason 3. (Aesthetic and Order). Specially in master-detail scenarios, this reads better, aligns better by name, and have more logical order (Master first, Detail second)</p>
</blockquote>
<p>이 이유도 정말 와닿는다.</p>
<p>부모 테이블과 상세 테이블 관계로 나타낼 때 보통 테이블 이름으로 그 관계를 나타낸다.</p>
<p>단수로 나타내면:</p>
<ul>
<li><em>Order</em></li>
<li><em>OrderDetail</em></li>
</ul>
<p>하지만 복수로 나타내면:</p>
<ul>
<li><em>Orders</em></li>
<li><em>OrderDetails</em></li>
</ul>
<p><em>작은 규칙</em>이 깨진다. <em>"테이블 이름을 Orders로 지었으니 OrdersDetails 였던가?"</em></p>
<h2 id="데이터베이스는-큐가-아닙니다" style="position:relative;"><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EB%8A%94-%ED%81%90%EA%B0%80-%EC%95%84%EB%8B%99%EB%8B%88%EB%8B%A4" aria-label="데이터베이스는 큐가 아닙니다 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>데이터베이스는 큐가 아닙니다.</h2>
<p><a href="https://news.hada.io/topic?id=6686">시스템 설계 자료 모음</a>에서
Message Queue Antipattern 단락의 <a href="https://blog.codepath.com/2012/11/15/asynchronous-processing-in-web-applications-part-1-a-database-is-not-a-queue/">A Database Is Not a Queue</a> 글을 읽었다.</p>
<p>데이터베이스를 큐로 사용하면 안된다는 내용이지만, 다른 관점으로는 메시지 큐 서비스가 제공하는 기능은 무엇인지 말하는 내용이기도 하다.</p>
<h3 id="why-not-a-database" style="position:relative;"><a href="#why-not-a-database" aria-label="why not a database permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why not a database?</h3>
<p>웹 스택에 새로운 기술을 도입하는 것을 꺼리기 때문에 데이터베이스를 그냥 사용하고 싶은 유독을 받을 수도 있을거라고 한다.
이미 RDMBS를 사용하고 있을 것이므로, 백그라운드처리 용도로 사용하면 빠르게 끝났다고 생각하겠지만 거기엔 많은 제약 사항과 고려할 점이 있다.</p>
<p>먼저 consuming 방식이다. producer는 테이블에 명령을 쌓고 consumer는 주기적으로 데이터를 polling 하는 것으로 구현하게 된다. 중요한 task면 초 단위로, 그렇지 않으면 몇 분이나 몇 시간마다 할 것이다.
문제는 짧은 주기의 polling이 긴 주기의 polling에 영향을 받는 거다. 모든 polling의 합 만큼 짧은 주기의 polling이 지연된다. 즉각적으로 처리해야 하는 task의 실행을 보장하기 어려워 진다.</p>
<p>consumer가 많아지면 중복 처리를 막기 위해 읽기 lock을 걸 수 밖에 없다. 그러면 consumer간 경쟁하게 된다.
모두 처리하기 전까지는 계속 lock을 걸테고 그러면 다른 consumer는 처리할 수 없다. 처리가 늦으면 producer가 생산하는 명령은 무한정 쌓인다.</p>
<p>완료한 작업을 삭제하는데도 문제가 있다. task가 쌓이기만 하면 계속 커질것이므로 주기적으로 삭제해야 한다.
task 처리하면서 발생하는 업데이트 쿼리와 삭제 쿼리가 함께 자주 발생하는 것은 효율적인 방식은 아니다.</p>
<p>이런 문제들이 합쳐지면 scaling하기 어렵다.</p>
<h3 id="redis를-사용하는-것은-어떨까" style="position:relative;"><a href="#redis%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%96%B4%EB%96%A8%EA%B9%8C" aria-label="redis를 사용하는 것은 어떨까 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redis를 사용하는 것은 어떨까?</h3>
<p>redis를 사용하는 것은 어떻게 생각하는지 물어보는 덧글이 있다.
ruby 생태계에서는 <a href="https://github.com/resque/resque">resque</a> 프로젝트가 있는데, 백그라운드 잡 관리용으로 redis를 사용하는 것이 흔하다고 한다.
다만 메시지 큐를 완전히 대체한다고 보긴 어렵고, 장기적으로 확장성, 잡 처리량, 메시지 처리 제어, 에러 핸들링에 놓치는 것이 있을 수 있다고 한다.</p>
<blockquote>
<p>I am really glad you brought this up. This is something I will covering in greater detail in my next post. In the ruby ecosystem, Redis is used very frequently as a job queue to some success with resque <a href="https://github.com/defunkt/resque">https://github.com/defunkt/resque</a> but that doesn’t mean redis is a true replacement for a MQ by any stretch. And I think by trying to replace the need for a true MQ with Redis, depending on requirements you may be missing out on more then initially realized in terms of long term scalability, job throughput, message delivery control, robust error handling, etc.</p>
</blockquote>
<h2 id="mysql" style="position:relative;"><a href="#mysql" aria-label="mysql permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MySQL</h2>
<h3 id="mysql-docker-image" style="position:relative;"><a href="#mysql-docker-image" aria-label="mysql docker image permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MySQL Docker Image</h3>
<p>Official mysql image: <a href="https://hub.docker.com/_/mysql">https://hub.docker.com/_/mysql</a></p>
<p>공식 이미지는 시작 시 <code class="language-text">docker-entrypoint-initdb.d/</code> 폴더에 sql, sh, gz 파일을 두면 자동으로 실행하는 구조로 되어있다.:</p>
<blockquote>
<p>it will execute files with extensions .sh, .sql and .sql.gz that are found in /docker-entrypoint-initdb.d</p>
</blockquote>
<h3 id="이미지-내에-데이터-포함하기" style="position:relative;"><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%82%B4%EC%97%90-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8F%AC%ED%95%A8%ED%95%98%EA%B8%B0" aria-label="이미지 내에 데이터 포함하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>이미지 내에 데이터 포함하기</h3>
<p>파일, 내용이 많으면 <code class="language-text">docker-entrypoint-initdb.d/</code>에 두는 것만으로는 시작이 오래 걸린다.
이를 해결하기 위해서 데이터를 이미지 내에 포함할 수 있다. 대신 이미지 크기가 그만큼 늘어난다.
개인적으로는 이 방법으로 테이블만 생성하고, integration 테스트하는데 사용하고 있다.</p>
<div class="gatsby-highlight" data-language="dockerfile"><pre class="language-dockerfile"><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> mysql:5.6 <span class="token keyword">AS</span> builder</span>

<span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"sed"</span>, <span class="token string">"-i"</span>, <span class="token string">"s/exec \"$@\"/echo \"not running $@\"/"</span>, <span class="token string">"/usr/local/bin/docker-entrypoint.sh"</span>]</span>

<span class="token instruction"><span class="token keyword">ENV</span> MYSQL_ROOT_PASSWORD=0000 <span class="token operator">\</span>
    MYSQL_DATABASE=test_quicket <span class="token operator">\</span>
    MYSQL_USER=testuser <span class="token operator">\</span>
    MYSQL_PASSWORD=testpassword</span>

<span class="token instruction"><span class="token keyword">COPY</span> schema /docker-entrypoint-initdb.d</span>

<span class="token instruction"><span class="token keyword">RUN</span> [<span class="token string">"/usr/local/bin/docker-entrypoint.sh"</span>, <span class="token string">"mysqld"</span>, <span class="token string">"--datadir"</span>, <span class="token string">"/initialized-db"</span>]</span>

<span class="token instruction"><span class="token keyword">FROM</span> mysql:5.6</span>

<span class="token instruction"><span class="token keyword">ENV</span> TZ=Asia/Seoul</span>

<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /initialized-db /var/lib/mysql</span></code></pre></div>
<ul>
<li>multi-stage build 이용하여 builder stage에서 설정 및 sql 파일을 복사하고 부트스트래핑 스크립트를 직접 실행한다.</li>
<li>main stage에서 builder의 DB 데이터를 COPY하고 실행한다.</li>
</ul>
<h3 id="functional-key-parts" style="position:relative;"><a href="#functional-key-parts" aria-label="functional key parts permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Functional Key Parts</h3>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/create-index.html#create-index-functional-key-parts">https://dev.mysql.com/doc/refman/8.0/en/create-index.html#create-index-functional-key-parts</a></p>
<blockquote>
<p>MySQL 8.0.13 and higher supports functional key parts that index expression values rather than column or column prefix values.</p>
</blockquote>
<p>MySQL 8.0.13에서부터 인덱스 생성 시 함수를 사용할 수 있다.</p>
<p>예를들어 컬럼에만 인덱스를 걸면:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stats
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">datetime</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_created_at <span class="token keyword">ON</span> stats <span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> stats <span class="token keyword">WHERE</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>id</strong></td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>select_type</strong></td>
<td align="left">SIMPLE</td>
</tr>
<tr>
<td align="left"><strong>table</strong></td>
<td align="left">stats</td>
</tr>
<tr>
<td align="left"><strong>partitions</strong></td>
<td align="left">NULL</td>
</tr>
<tr>
<td align="left"><strong>type</strong></td>
<td align="left">index</td>
</tr>
<tr>
<td align="left"><strong>possible_keys</strong></td>
<td align="left">NULL</td>
</tr>
<tr>
<td align="left"><strong>key</strong></td>
<td align="left">idx_created_at</td>
</tr>
<tr>
<td align="left"><strong>key_len</strong></td>
<td align="left">5</td>
</tr>
<tr>
<td align="left"><strong>ref</strong></td>
<td align="left">NULL</td>
</tr>
<tr>
<td align="left"><strong>rows</strong></td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>filtered</strong></td>
<td align="left">100</td>
</tr>
<tr>
<td align="left"><strong>Extra</strong></td>
<td align="left">Using where; Using index</td>
</tr>
</tbody>
</table>
<p>하지만 functional key parts를 사용하면:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stats
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    created_at <span class="token keyword">datetime</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_created_at_month <span class="token keyword">ON</span> stats <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> stats <span class="token keyword">WHERE</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>created_at<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>id</strong></td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>select_type</strong></td>
<td align="left">SIMPLE</td>
</tr>
<tr>
<td align="left"><strong>table</strong></td>
<td align="left">stats</td>
</tr>
<tr>
<td align="left"><strong>partitions</strong></td>
<td align="left">NULL</td>
</tr>
<tr>
<td align="left"><strong>type</strong></td>
<td align="left">ref</td>
</tr>
<tr>
<td align="left"><strong>possible_keys</strong></td>
<td align="left">idx_created_at_month</td>
</tr>
<tr>
<td align="left"><strong>key</strong></td>
<td align="left">idx_created_at_month</td>
</tr>
<tr>
<td align="left"><strong>key_len</strong></td>
<td align="left">5</td>
</tr>
<tr>
<td align="left"><strong>ref</strong></td>
<td align="left">const</td>
</tr>
<tr>
<td align="left"><strong>rows</strong></td>
<td align="left">1</td>
</tr>
<tr>
<td align="left"><strong>filtered</strong></td>
<td align="left">100</td>
</tr>
<tr>
<td align="left"><strong>Extra</strong></td>
<td align="left">NULL</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Functional indexes are implemented as hidden virtual generated columns, which has these implications:</p>
</blockquote>
<p>이 인덱스는 숨겨진 가상 컬럼으로 구현된다. 따라서 컬럼의 제약을 따른다:</p>
<ul>
<li>테이블의 총 컬럼 수 제한에 포함된다. <a href="https://dev.mysql.com/doc/refman/8.0/en/column-count-limit.html">Innodb의 경우 1017개</a>.</li>
<li>해당 컬럼에서 사용 가능한 함수만 함수 인덱스에 사용 가능</li>
<li>virtual column은 저장 공간을 차지하지 않지만, 인덱스는 차지한다.</li>
</ul>
<h3 id="secondary-indexes-and-generated-columns" style="position:relative;"><a href="#secondary-indexes-and-generated-columns" aria-label="secondary indexes and generated columns permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Secondary Indexes and Generated Columns</h3>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/create-table-secondary-indexes.html">https://dev.mysql.com/doc/refman/8.0/en/create-table-secondary-indexes.html</a></p>
<p>Virtual Column은 MySQL 5.7에서 추가되었다.
Funcitonal Key Parts를 사용할 수 없었던 5.7에서는 Virtual Column을 이용하여 대체 사용할 수 있다.</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> jemp <span class="token punctuation">(</span>
  c JSON<span class="token punctuation">,</span>
  g <span class="token keyword">INT</span> GENERATED ALWAYS <span class="token keyword">AS</span> <span class="token punctuation">(</span>c<span class="token operator">-</span><span class="token operator">></span><span class="token string">"$.id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> i <span class="token punctuation">(</span>g<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">GENERATED ALWAYS AS</code>를 사용하여 Virtual Column을 생성한다.
이 컬럼에 대해 정의한 인덱스를 "Virtual Column"라 한다.</p>
<h2 id="h2-database" style="position:relative;"><a href="#h2-database" aria-label="h2 database permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>H2 Database</h2>
<h3 id="numberformatexception-for-input-string--에러" style="position:relative;"><a href="#numberformatexception-for-input-string--%EC%97%90%EB%9F%AC" aria-label="numberformatexception for input string  에러 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">NumberFormatException: for input String: "..."</code> 에러</h3>
<p><code class="language-text">UNION ALL</code> 쿼리로 3개의 테이블을 포함하고, 컬럼 하나가 integer 타입일 때 발생했다.</p>
<p><code class="language-text">CAST(foo as char)</code> 명시적으로 타입 캐스팅을 통해 통일하여 해결했다.</p>
<h2 id="postgresql" style="position:relative;"><a href="#postgresql" aria-label="postgresql permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PostgreSQL</h2>
<p><a href="../postgresql">PostgreSQL</a> 문서에서 내용을 다룸.</p>
<h2 id="realworld-data-dump" style="position:relative;"><a href="#realworld-data-dump" aria-label="realworld data dump permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Realworld Data Dump</h2>
<p>Stack Exchange는 주기적으로 데이터 덤프를 제공한다.
각 사이트의 모든 질문과 답변 등을 포함하는 데이터 파일이다.</p>
<p><a href="https://archive.org/details/stackexchange">https://archive.org/details/stackexchange</a></p>
<p>데이터 사이즈는 2024년 기준으로 92.3GB이다.</p>
<p>온라인에서 직접 쿼리할 수 있는 <a href="https://data.stackexchange.com/stackoverflow/query/new">화면</a>을 제공한다.
대략적인 스키마 정보나 쿼리 에디터를 사용할 수 있다.</p>
<h2 id="sqlite의-알려지지-않은-이야기" style="position:relative;"><a href="#sqlite%EC%9D%98-%EC%95%8C%EB%A0%A4%EC%A7%80%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0" aria-label="sqlite의 알려지지 않은 이야기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SQLite의 알려지지 않은 이야기</h2>
<p><a href="https://news.hada.io/topic?id=4558">https://news.hada.io/topic?id=4558</a></p>
<p>많은 개발 토픽이 담겨있다.</p>
<h3 id="mcdc-coverage" style="position:relative;"><a href="#mcdc-coverage" aria-label="mcdc coverage permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MC/DC Coverage</h3>
<p>본문 중:</p>
<blockquote>
<p>실제로 DO-178B의 프로세스를 따르기 시작했고, 그중 하나가 100% MCDC Test Coverage</p>
<ul>
<li>MCDC(Modified Condition / Decision Coverage) [3] 는 테스트가 개별 분기를 적어도 한번 이상 통과해야 하는 것</li>
<li>SQLite 가 MCDC 100% 가 되는데 주당 60시간 기준으로 1년이 걸렸음. 정말 정말 어려웠음. 매일 12시간을 해야 했고 정말 피곤.</li>
<li>90~95% 의 테스트 커버리지는 쉬운데 나머지 5%가 정말 어려움. 하지만 1년간 그렇게 해서 최종적으로 100%에 도달하자 Android 에서 버그리포트가 오지 않게 되었음</li>
<li>그때부터 작동하기 시작했고, 큰 차이를 내었음. 그 이후 8~-9년동안 버그가 없었음.</li>
</ul>
</blockquote>
<blockquote>
<p>MCDC 100% 커버리지는 TH3 라고 부르고 공개하지 않음 (proprietary)</p>
</blockquote>
<p><a href="https://www.sten.or.kr/bbs/board.php?bo_table=free&#x26;wr_id=24033">MC/DC 커버리지 의미 아시는분?</a></p>
<blockquote>
<p>전체 경우의 수의 테이블을 보고 위와 같은 식으로 A, B, C 각각의 개별조건식이 전체 조건식(D)에 영향을 주는 TC를 찾아내면 MC/DC 커버리지 100%를 충족하게 됩니다.</p>
</blockquote>
<p>MC/DC Coverage는 expression에서 모든 branch를 커버하기 위한 Test Case를 만들기 위한 방법으로 보인다.</p>
<h3 id="do-127b" style="position:relative;"><a href="#do-127b" aria-label="do 127b permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DO-127B</h3>
<p>본문 중:</p>
<blockquote>
<p>실제로 DO-178B의 프로세스를 따르기 시작했고, 그중 하나가 100% MCDC Test Coverage</p>
</blockquote>
<p><a href="https://ko.wikipedia.org/wiki/DO-178B">DO-178B - Wikipedia</a></p>
<blockquote>
<p>DO-178B (항공기 시스템과 장비 인증에 관한 소프트웨어 고려사항)는 RTCA 사에 의해 발표된 소프트웨어 개발 표준이다.</p>
</blockquote>
<h3 id="covering-index" style="position:relative;"><a href="#covering-index" aria-label="covering index permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>covering index</h3>
<p>본문 중:</p>
<blockquote>
<p>예를 들어서, 나는 Covering Index에 대해서는 전혀 몰랐는데, 독일에서 열린 PHP 컨퍼런스에 참석했을 때, MySQL의 David Axmark도 참여해서 강연을 했음</p>
</blockquote>
<p>ㅤ→ 그 강연에서 MysQL 이 어떻게 Covering Index를 만들었는지 설명함
ㅤ→ DB의 인덱스에 여러개 컬럼이 있을때, 인덱스의 앞쪽 컬럼에 대해서만 쿼리하고 답이 나머지 컬럼에 있다면 DB는 원본 테이블 조회없이 인덱스만으로도 사용 가능해서 작업이 빨라짐
ㅤ→ 그래서 집으로 돌아오는 비행기에서 사람이 별로 없길래, 랩탑을 열고 대서양 상공에서 SQLite 의 커버링 인덱스를 구현했음</p>
<p><a href="https://www.cubrid.com/blog/3821500">CUBRID 커버링 인덱스(covering index) 이야기</a></p>
<blockquote>
<p>아래 예제-1)에서 SELECT 질의의 WHERE 조건에 사용된 컬럼 i와, SELECT 리스트로 주어진 컬럼 j는 모두 인덱스 idx를 구성하는 컬럼입니다. 이와 같은 경우에 CUBRID는 SELECT 질의를 수행할 때 커버링 인덱스를 스캔 하게 됩니다, 이는 하나의 인덱스가 SELECT 문이 요구하는 조건과 결과를 모두 포함하고 있기 때문에 가능한 일입니다.</p>
<p>예제-1)
CREATE TABLE tbl (i INT, j INT);
CREATE INDEX idx ON tbl(i, j);
SELECT j FROM tbl WHERE i > 0;</p>
</blockquote>
<h3 id="fossil" style="position:relative;"><a href="#fossil" aria-label="fossil permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fossil</h3>
<p>본문 중:</p>
<blockquote>
<p>Fossil 구축</p>
<ul>
<li>Git 과 Mercurial 을 보고 요구사항을 정리한뒤 직접 버전관리 시스템을 개발하기로 함</li>
<li>이제 Fossil 은 잘 동작해서, 자체 프로젝트가 되었음</li>
<li>토발즈가 Linux Kernel 개발을 지원하기 위해 Git을 만들었기에, Linux Kernel 관련 일을 한다면 Git 이 완벽한 버전관리 시스템</li>
</ul>
</blockquote>
<p><a href="https://www.fossil-scm.org/home/doc/trunk/www/index.wiki">Fossile</a></p>
<blockquote>
<p><strong>Quick Start</strong></p>
<ol>
<li><a href="https://www.fossil-scm.org/home/uv/download.html">Download</a> or install using a package manager or <a href="https://www.fossil-scm.org/home/doc/trunk/www/build.wiki">compile from sources</a>.</li>
<li>fossil init REPOSITORY-DIR/new-repository</li>
<li>fossil open REPOSITORY-DIR/new-repository</li>
<li>fossil add files-or-directories</li>
<li>fossil commit -m "commit message"</li>
<li>fossil ui</li>
</ol>
</blockquote>
<p>git 사용법과 흡사하다.</p>
<h3 id="인상깊은-부분" style="position:relative;"><a href="#%EC%9D%B8%EC%83%81%EA%B9%8A%EC%9D%80-%EB%B6%80%EB%B6%84" aria-label="인상깊은 부분 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>인상깊은 부분</h3>
<blockquote>
<p>90~95% 의 테스트 커버리지는 쉬운데 나머지 5%가 정말 어려움. 하지만 1년간 그렇게 해서 최종적으로 100%에 도달하자 Android 에서 버그리포트가 오지 않게 되었음</p>
</blockquote>
<p>이게 정말 가능할까? 본문을 읽어보면 테스트 케에스에 진심으로 보이는데, 모든 branch도 100% 달성했을 가능성이 있다.
내 경우 새 기능을 추가할 때 별다른 노력 없이도 커버리지 90%에 근접했다.
나머지는 언어 특성으로 인해 테스트를 위해 코드를 재작성이 필요하거나, 너무 사소하다고 생각되는 부분이었다.
하지만 100% 달성에 노력하는 것은 매우 가치있는 일인 거 같다.</p>
<h2 id="scraps" style="position:relative;"><a href="#scraps" aria-label="scraps permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scraps</h2>
<p><a href="https://news.hada.io/topic?id=12665">GitHub가 MySQL 5.7에서 MySQL 8.0으로 넘어가는 과정</a><br>
대규모 시스템에서 데이터베이스를 마이그레이션 과정에서 얻은 경험. 읽어보면 예상한대로 매우 신중한 작업임을 알 수 있다.</p></div><div class="Comments__Container-sc-1ajj4d9-0 gcJKrk"><hr/><div></div></div></div></div><div class="PageLayout__Side-sc-11jfopf-2 fytAKM"><div class="RelatedLinks__Container-sc-1y1aimd-0 ldECpH Wiki__RelatedLinksSide-sc-16q9onf-6 dStlil"><h3 class="RelatedLinks__Header-sc-1y1aimd-1 fTEgtV">Related</h3><ul class="RelatedLinks__Links-sc-1y1aimd-2 eZRzcg"><li><a href="../postgresql" class="Link__A-sc-k1di17-0 bUjFDA">PostgreSQL</a></li><li><a href="../jetbrains" class="Link__A-sc-k1di17-0 bUjFDA">JetBrains</a></li><li><a href="../programming-paradigm" class="Link__A-sc-k1di17-0 bUjFDA">Programming Paradigm</a></li><li><a href="../philosophy" class="Link__A-sc-k1di17-0 bUjFDA">개인적인 철학</a></li><li><a href="../docker" class="Link__A-sc-k1di17-0 bUjFDA">Docker</a></li></ul></div><div class="Wiki__TocSide-sc-16q9onf-5 chvTXK"><h3 class="Toc__Header-sc-1f76i2s-0 jArVBC">Table of Contents</h3><div class="Toc__Container-sc-1f76i2s-1 bJJrFa"><ul>
<li>
<p><a href="#database">Database</a></p>
<ul>
<li>
<p><a href="#%EC%84%A4%EA%B3%84">설계</a></p>
<ul>
<li>
<p><a href="#%EC%A0%95%EA%B7%9C%ED%99%94-normalization">정규화 (Normalization)</a></p>
<ul>
<li><a href="#%EC%A0%9C-1-%EC%A0%95%EA%B7%9C%ED%99%94-first-normal-form">제 1 정규화 (First Normal Form)</a></li>
<li><a href="#%EC%A0%9C-2-%EC%A0%95%EA%B7%9C%ED%99%94-second-normal-form">제 2 정규화 (Second Normal Form)</a></li>
<li><a href="#%EC%A0%9C-3-%EC%A0%95%EA%B7%9C%ED%99%94-third-normal-form">제 3 정규화 (Third Normal Form)</a></li>
<li><a href="#%EC%97%AD-%EC%A0%95%EA%B7%9C%ED%99%94-denormalization">역 정규화 (Denormalization)</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="#%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%9D%B4%EB%A6%84-%EC%BB%A8%EB%B2%A4%EC%85%98">테이블 이름 컨벤션</a></p>
<ul>
<li><a href="#%EB%8B%A8%EC%88%98-vs-%EB%B3%B5%EC%88%98">단수 vs. 복수</a></li>
</ul>
</li>
<li>
<p><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EB%8A%94-%ED%81%90%EA%B0%80-%EC%95%84%EB%8B%99%EB%8B%88%EB%8B%A4">데이터베이스는 큐가 아닙니다.</a></p>
<ul>
<li><a href="#why-not-a-database">Why not a database?</a></li>
<li><a href="#redis%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B2%83%EC%9D%80-%EC%96%B4%EB%96%A8%EA%B9%8C">Redis를 사용하는 것은 어떨까?</a></li>
</ul>
</li>
<li>
<p><a href="#mysql">MySQL</a></p>
<ul>
<li><a href="#mysql-docker-image">MySQL Docker Image</a></li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%82%B4%EC%97%90-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8F%AC%ED%95%A8%ED%95%98%EA%B8%B0">이미지 내에 데이터 포함하기</a></li>
<li><a href="#functional-key-parts">Functional Key Parts</a></li>
<li><a href="#secondary-indexes-and-generated-columns">Secondary Indexes and Generated Columns</a></li>
</ul>
</li>
<li>
<p><a href="#h2-database">H2 Database</a></p>
<ul>
<li><a href="#numberformatexception-for-input-string--%EC%97%90%EB%9F%AC"><code class="language-text">NumberFormatException: for input String: "..."</code> 에러</a></li>
</ul>
</li>
<li>
<p><a href="#postgresql">PostgreSQL</a></p>
</li>
<li>
<p><a href="#realworld-data-dump">Realworld Data Dump</a></p>
</li>
<li>
<p><a href="#sqlite%EC%9D%98-%EC%95%8C%EB%A0%A4%EC%A7%80%EC%A7%80-%EC%95%8A%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0">SQLite의 알려지지 않은 이야기</a></p>
<ul>
<li><a href="#mcdc-coverage">MC/DC Coverage</a></li>
<li><a href="#do-127b">DO-127B</a></li>
<li><a href="#covering-index">covering index</a></li>
<li><a href="#fossil">Fossil</a></li>
<li><a href="#%EC%9D%B8%EC%83%81%EA%B9%8A%EC%9D%80-%EB%B6%80%EB%B6%84">인상깊은 부분</a></li>
</ul>
</li>
<li>
<p><a href="#scraps">Scraps</a></p>
</li>
</ul>
</li>
</ul></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1L3R7GGF7P"></script><script>
      
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-1L3R7GGF7P',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-1L3R7GGF7P', {"anonymize_ip":true,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/wiki/database/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-3ddcda02344f3034631f.js\"],\"component---src-components-gatsby-templates-wiki-tsx\":[\"/component---src-components-gatsby-templates-wiki-tsx-2dc4cac91431a09bfced.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-10d51ee2f28b984f9269.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-0d594ef74e2e0bd808b2.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="1827e04ce08c40d80e80";</script><script src="/cat-logic/webpack-runtime-30995efbc2a85a0c099f.js" async></script><script src="/cat-logic/framework-4bfcb0a3c03c938f10bc.js" async></script><script src="/cat-logic/app-3ddcda02344f3034631f.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>